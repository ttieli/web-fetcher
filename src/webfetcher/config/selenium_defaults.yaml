# Selenium Configuration for Web_Fetcher
# OPTIMIZED: Session-preserving Chrome connection only
# This configuration file provides default settings for Selenium integration
# with Chrome debug port connection to preserve login sessions.

# Chrome Debug Connection Settings
chrome:
  debug_port: 9222               # Must match config/chrome-debug.sh port
  debug_host: "localhost"        # Debug session host
  user_data_dir: "~/.chrome-wf"  # Must match chrome-debug.sh PROFILE_DIR
  health_check_timeout: 15       # Health check timeout in seconds (Task-002 Phase 1)
  
# Connection Management
connection:
  max_connection_attempts: 3     # Number of connection retry attempts
  connection_timeout: 10         # Timeout for initial connection (seconds)
  fallback_strategy: "fail_gracefully"  # NEVER fallback to headless (loses login state)
  preserve_session: true         # Core requirement - maintain login state
  
# Chrome Instance Options
options:
  headless: false                # ALWAYS false - session preservation requirement
  use_existing_session: true     # Connect to chrome-debug.sh session only
  no_new_instance: true          # Prevent starting competing Chrome instances
  
# REMOVED: All headless and new instance options that break session preservation
  
# Timeout Configurations (seconds)
timeouts:
  page_load: 30                  # Page load timeout - match existing urllib timeout
  script: 10                     # JavaScript execution timeout
  implicit_wait: 5               # Implicit wait for elements
  element_wait: 15               # Explicit wait for specific elements
  
# Wait Conditions for Page Loading
wait_conditions:
  default_selector: "body"       # Basic page load indicator
  js_complete: "return document.readyState === 'complete'"  # JavaScript completion check
  images_loaded: "return Array.from(document.images).every(img => img.complete)"  # Image loading check
  
# Retry Configuration
retry:
  max_attempts: 2                # Fewer attempts than urllib (selenium is slower)
  backoff_factor: 1.5            # Less aggressive backoff than urllib
  
# JavaScript Detection Settings
js_detection:
  enabled: true                  # Enable automatic JS detection for auto mode
  indicators:                    # JavaScript framework indicators
    - "React"
    - "Vue"
    - "Angular"
    - "document.getElementById"
    - "window.onload"
    - "jQuery"
    - "$(document).ready"
    - "window.addEventListener"
  content_threshold: 100         # Minimum content length to consider JS-rendered
  
# Chrome Options for Stability
chrome_options:
  - "--disable-features=VizDisplayCompositor"  # Stability improvement
  - "--disable-extensions"       # Reduce overhead
  - "--no-sandbox"               # Required for some environments
  - "--disable-dev-shm-usage"    # Reduce memory usage
  - "--disable-gpu"              # Avoid GPU issues
  - "--disable-blink-features=AutomationControlled"  # Reduce automation detection
  
# Performance Optimization
performance:
  disable_images: false          # Set to true to improve load speed
  disable_javascript: false     # NEVER disable - would defeat the purpose
  block_ads: false               # Optional ad blocking
  
# Logging Configuration
logging:
  level: "INFO"                  # Log level for Selenium operations
  selenium_debug: false          # Enable Selenium's verbose logging
  chrome_debug: false            # Enable Chrome's debug logging
  
# Session Management
session:
  preserve_cookies: true         # Maintain cookies across requests
  preserve_local_storage: true   # Maintain local storage
  preserve_session_storage: true # Maintain session storage
  clear_cache_on_startup: false  # Don't clear cache (preserves login state)
  
# User Agent Settings
user_agent:
  override: false                # Don't override Chrome's default user agent
  custom_ua: ""                  # Custom user agent string (if override=true)
  
# Viewport Configuration
viewport:
  width: 1920                    # Browser window width
  height: 1080                   # Browser window height
  device_scale_factor: 1.0       # Device pixel ratio
  
# Network Configuration
network:
  load_timeout: 30               # Network load timeout
  idle_timeout: 5                # Time to wait for network idle
  disable_background_requests: false  # Block background requests
  
# Error Handling
error_handling:
  screenshot_on_error: false     # Take screenshot when errors occur
  continue_on_error: true        # Continue execution after non-critical errors
  max_error_retries: 2           # Maximum retries for recoverable errors
  
# Development and Testing
development:
  enable_dev_tools: false        # Enable Chrome DevTools
  slow_motion: 0                 # Delay between actions (ms) for debugging
  debug_mode: false              # Enable additional debug output

# Browser Notification Settings (Task-010 Solution E)
# 浏览器通知设置 - 帮助用户识别正确的Chrome实例
browser_notification:
  enabled: true                  # Show notification page when connecting
  auto_close: 0                  # Auto-close after N seconds (0 = manual close)
  show_on_reconnect: false       # Show notification on reconnection attempts