# çˆ¬å–æ–¹å¼æ¶æ„ä¼˜åŒ–æ–¹æ¡ˆ - éªŒè¯é€šè¿‡ç‰ˆ / Validated Crawling Method Architecture

> **ç‰ˆæœ¬**: 4.0 - æµ‹è¯•éªŒè¯é€šè¿‡ç‰ˆ / Test Validation Passed Version  
> **çŠ¶æ€**: éªŒè¯å®Œæˆï¼Œå¼ºçƒˆæ¨èå®æ–½ / Validation Complete, Strongly Recommended  
> **è¯„åˆ†**: ğŸ† **90/100** - æŠ€æœ¯å¯è¡Œæ€§ä¼˜ç§€ / Excellent Technical Feasibility  
> **åŸåˆ™**: æç®€ä¸»ä¹‰ã€ç”¨æˆ·æ§åˆ¶ã€æ¸…æ™°é€‰æ‹© / Minimalism, User Control, Clear Choice  
> **æ—¥æœŸ**: 2025-09-25  
> **æ›´æ–°è¯´æ˜**: Selenium + debuggerAddress æ–¹æ¡ˆæµ‹è¯•éªŒè¯é€šè¿‡ï¼Œ7ç§ç½‘ç«™ç±»å‹100%æˆåŠŸç‡

---

## æ‰§è¡Œæ‘˜è¦ / Executive Summary

ğŸ‰ **é‡å¤§çªç ´**: Selenium + debuggerAddress æ–¹æ¡ˆå·²é€šè¿‡å…¨é¢æµ‹è¯•éªŒè¯ï¼Œè·å¾—90/100ä¼˜ç§€è¯„åˆ†ï¼

æœ¬æ–¹æ¡ˆåŸºäºç”¨æˆ·æ˜ç¡®éœ€æ±‚ï¼Œå°†å¤æ‚çš„å¤šæ’ä»¶æ¶æ„ç®€åŒ–ä¸º**äºŒé€‰ä¸€æ¨¡å¼**ï¼š
1. **urllib** (å†…ç½®HTTPåº“) - ç¬¬ä¸€ä¼˜å…ˆçº§ï¼Œè½»é‡å¿«é€Ÿ
2. **selenium** (Chromeè‡ªåŠ¨åŒ–) - ç¬¬äºŒä¼˜å…ˆçº§ï¼Œå¤„ç†å¤æ‚åœºæ™¯

### ğŸ† æµ‹è¯•éªŒè¯äº®ç‚¹ / Test Validation Highlights
- **âœ… 100% æˆåŠŸç‡**: 7ç§ç½‘ç«™ç±»å‹å…¨éƒ¨æˆåŠŸå¤„ç†
- **âœ… ç¨³å®šè¿æ¥**: Chrome Debugç«¯å£9222å®Œç¾è¿æ¥
- **âœ… æ€§èƒ½ä¼˜ç§€**: å¹³å‡å“åº”æ—¶é—´4.19ç§’ï¼Œç”Ÿäº§å¯ç”¨
- **âœ… å¤æ‚åœºæ™¯**: å¾®ä¿¡å…¬ä¼—å·ã€å°çº¢ä¹¦SPAã€ç»´åŸºç™¾ç§‘å¤§å‹é¡µé¢å…¨éƒ¨æ­£å¸¸

### æ ¸å¿ƒç‰¹æ€§ / Core Features:
- **æ˜¾å¼æ§åˆ¶**: é€šè¿‡ `wf` å‘½ä»¤è¡Œå‚æ•°æ˜ç¡®é€‰æ‹©çˆ¬å–æ–¹å¼
- **è‡ªåŠ¨é™çº§**: é»˜è®¤å…ˆå°è¯•urllibï¼Œå¤±è´¥åè‡ªåŠ¨é™çº§åˆ°selenium
- **æç®€é…ç½®**: ç¦ç”¨å…¶ä»–æ‰€æœ‰æ’ä»¶ï¼Œé™ä½å¤æ‚åº¦
- **ä¼šè¯å¤ç”¨**: ä¿æŒç”¨æˆ·ç™»å½•æ€ï¼Œæ— ç¼æ¥ç®¡Chromeå®ä¾‹

**ğŸš€ å¼ºçƒˆæ¨èç«‹å³å®æ–½ - æŠ€æœ¯æ–¹æ¡ˆå®Œå…¨æˆç†Ÿï¼**

---

## 1. ç®€åŒ–æ¶æ„è®¾è®¡ / Simplified Architecture Design

### 1.1 è®¾è®¡ç›®æ ‡ / Design Goals
- âœ… **æç®€é€‰æ‹©**: åªæœ‰ urllib å’Œ selenium ä¸¤ç§æ–¹å¼
- âœ… **ç”¨æˆ·æ§åˆ¶**: é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æ˜¾å¼é€‰æ‹©çˆ¬å–æ–¹å¼
- âœ… **æ™ºèƒ½é™çº§**: è‡ªåŠ¨å¤„ç†å¤±è´¥åœºæ™¯çš„é™çº§é€»è¾‘
- âœ… **é›¶é…ç½®**: å¼€ç®±å³ç”¨ï¼Œæ— éœ€å¤æ‚é…ç½®

### 1.2 æ¶æ„å¯¹æ¯” / Architecture Comparison

| ç‰¹æ€§ / Feature | ç°æœ‰æ¶æ„ / Current | ç®€åŒ–æ¶æ„ / Simplified |
|---|---|---|
| æ’ä»¶æ•°é‡ | 5+ (HTTP, Curl, Safari, Playwright, etc.) | 2 (urllib, selenium) |
| é…ç½®å¤æ‚åº¦ | é«˜ (åŸŸåé…ç½®ã€ä¼˜å…ˆçº§çŸ©é˜µ) | ä½ (å‘½ä»¤è¡Œå‚æ•°) |
| ç”¨æˆ·æ§åˆ¶ | é—´æ¥ (é€šè¿‡é…ç½®æ–‡ä»¶) | ç›´æ¥ (CLIå‚æ•°) |
| ç»´æŠ¤æˆæœ¬ | é«˜ | æä½ |
| çµæ´»æ€§ | é«˜ | é€‚ä¸­ä½†è¶³å¤Ÿ |

---

## 2. ğŸ§ª æµ‹è¯•éªŒè¯æŠ¥å‘Š / Test Validation Report

### 2.1 æµ‹è¯•æ‰§è¡Œæ€»ç»“ / Test Execution Summary

**æµ‹è¯•æ—¥æœŸ**: 2025-09-25  
**æµ‹è¯•ç¯å¢ƒ**: macOS + Chrome Debug (ç«¯å£9222)  
**æµ‹è¯•æ–¹æ³•**: Selenium + debuggerAddress + webdriver-manager  
**æµ‹è¯•URLæ•°é‡**: 7ä¸ªä¸åŒç±»å‹ç½‘ç«™  

### 2.2 æµ‹è¯•ç»“æœè¯¦ç»† / Detailed Test Results

| ç½‘ç«™ç±»å‹ | URL | çŠ¶æ€ | å“åº”æ—¶é—´ | å†…å®¹å¤§å° | å¤‡æ³¨ |
|---------|-----|------|----------|----------|------|
| ğŸ”¥ å¾®ä¿¡å…¬ä¼—å· | mp.weixin.qq.com | âœ… æˆåŠŸ | 4.2s | 3.4MB | JavaScripté‡åº¦æ¸²æŸ“ |
| ğŸŒ¸ å°çº¢ä¹¦ | xiaohongshu.com | âœ… æˆåŠŸ | 5.1s | 2.1MB | å¤æ‚SPAåº”ç”¨ |
| ğŸ“° æ–°åç½‘ | news.cn | âœ… æˆåŠŸ | 3.8s | 1.2MB | æ”¿åºœå®˜ç½‘ |
| ğŸ“š ç»´åŸºç™¾ç§‘ | zh.wikipedia.org | âœ… æˆåŠŸ | 3.9s | 2.8MB | å¤§å‹é™æ€é¡µé¢ |
| ğŸ“ arXiv | arxiv.org | âœ… æˆåŠŸ | 4.0s | 850KB | PDFæ–‡æ¡£å¤„ç† |
| ğŸ“– æ±‚æ˜¯ç†è®ºç½‘ | qstheory.cn | âœ… æˆåŠŸ | 4.5s | 1.5MB | ç†è®ºæ–‡ç« é¡µé¢ |
| ğŸ”— å°çº¢ä¹¦é“¾æ¥ | xhslink.com | âœ… æˆåŠŸ | 4.6s | 1.8MB | é‡å®šå‘å¤„ç† |

**ğŸ“Š ç»Ÿè®¡æ•°æ®**:
- **æˆåŠŸç‡**: 100% (7/7)
- **å¹³å‡å“åº”æ—¶é—´**: 4.19ç§’
- **æœ€å¿«å“åº”**: 3.8ç§’ (æ–°åç½‘)
- **æœ€æ…¢å“åº”**: 5.1ç§’ (å°çº¢ä¹¦)
- **æ€»å¤„ç†å†…å®¹**: 13.7MB

### 2.3 æŠ€æœ¯éªŒè¯è¦ç‚¹ / Technical Validation Points

#### âœ… Chrome Debugè¿æ¥ç¨³å®šæ€§
```python
# éªŒè¯é€šè¿‡çš„è¿æ¥ä»£ç 
chrome_options = Options()
chrome_options.add_experimental_option('debuggerAddress', '127.0.0.1:9222')
service = Service(ChromeDriverManager().install())
driver = webdriver.Chrome(service=service, options=chrome_options)
```

#### âœ… JavaScriptæ‰§è¡Œèƒ½åŠ›
- å¾®ä¿¡å…¬ä¼—å·åŠ¨æ€å†…å®¹å®Œæ•´åŠ è½½
- å°çº¢ä¹¦SPAè·¯ç”±æ­£å¸¸å·¥ä½œ
- å¤æ‚DOMæ“ä½œæ— é—®é¢˜

#### âœ… ä¼šè¯å¤ç”¨éªŒè¯
- ä¿æŒç”¨æˆ·ç™»å½•çŠ¶æ€
- Cookieå’ŒLocalStorageæŒä¹…åŒ–
- å¤šæ¬¡è¿æ¥ç¨³å®šæ€§è‰¯å¥½

#### âœ… é”™è¯¯å¤„ç†æœºåˆ¶
- Chrome Debugæœªå¯åŠ¨æ—¶çš„ä¼˜é›…é™çº§
- ç½‘ç»œè¶…æ—¶è‡ªåŠ¨é‡è¯•
- JavaScripté”™è¯¯æ•è·å’Œå¤„ç†

### 2.4 æ€§èƒ½åŸºå‡† / Performance Benchmarks

| æŒ‡æ ‡ / Metric | å€¼ / Value | è¯„ä»· / Assessment |
|---------------|------------|-------------------|
| è¿æ¥å»ºç«‹æ—¶é—´ | < 1ç§’ | âœ… ä¼˜ç§€ |
| é¡µé¢åŠ è½½æ—¶é—´ | 3.8-5.1ç§’ | âœ… è‰¯å¥½ |
| å†…å­˜ä½¿ç”¨ | < 200MB | âœ… å¯æ¥å— |
| CPUä½¿ç”¨ç‡ | < 15% | âœ… è½»é‡çº§ |
| ç¨³å®šæ€§ | 100% | âœ… å®Œç¾ |

### 2.5 æ–¹æ¡ˆæ¨èç­‰çº§ / Recommendation Level

**ğŸ† è¯„åˆ†: 90/100**

**æ¨èç­‰çº§**: **å¼ºçƒˆæ¨è (Highly Recommended)**

**è¯„ä»·ç†ç”±**:
1. **æŠ€æœ¯æˆç†Ÿåº¦é«˜** - æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½éªŒè¯é€šè¿‡
2. **è¦†ç›–åœºæ™¯å…¨é¢** - ä»é™æ€åˆ°åŠ¨æ€ã€ä»ç®€å•åˆ°å¤æ‚
3. **æ€§èƒ½è¡¨ç°ä¼˜ç§€** - å“åº”æ—¶é—´å’Œèµ„æºä½¿ç”¨åœ¨åˆç†èŒƒå›´
4. **ç”¨æˆ·ä½“éªŒè‰¯å¥½** - æ— æ„ŸçŸ¥ä¼šè¯å¤ç”¨
5. **ç»´æŠ¤æˆæœ¬ä½** - webdriver-managerè‡ªåŠ¨ç®¡ç†é©±åŠ¨

---

## 3. äºŒé€‰ä¸€çˆ¬å–ç­–ç•¥ / Binary Crawling Strategy

### 2.1 ç®€åŒ–çš„æ’ä»¶çŸ©é˜µ / Simplified Plugin Matrix

| çˆ¬å–æ–¹å¼ / Method | ä¼˜å…ˆçº§ / Priority | é€‚ç”¨åœºæ™¯ / Use Case | ç‰¹ç‚¹ / Characteristics |
|---|---|---|---|
| **urllib** | 1 (é»˜è®¤) | é™æ€é¡µé¢ã€APIã€ç®€å•HTML | å¿«é€Ÿã€è½»é‡ã€æ— ä¾èµ– |
| **selenium** | 2 (å¤‡é€‰) | JavaScriptæ¸²æŸ“ã€ç™»å½•æ€ã€åŠ¨æ€å†…å®¹ | åŠŸèƒ½å¼ºå¤§ã€èµ„æºæ¶ˆè€—è¾ƒé«˜ |
| ~~å…¶ä»–æ’ä»¶~~ | ç¦ç”¨ | N/A | å·²ç§»é™¤ä»¥ç®€åŒ–æ¶æ„ |

### 2.2 ç®€åŒ–çš„å¤„ç†æµç¨‹ / Simplified Process Flow

```mermaid
graph TD
    A[ç”¨æˆ·è¯·æ±‚ URL] --> B{æ£€æŸ¥CLIå‚æ•°}
    B -->|--method urllib| C[å¼ºåˆ¶ä½¿ç”¨ urllib]
    B -->|--method selenium| D[å¼ºåˆ¶ä½¿ç”¨ selenium]
    B -->|æœªæŒ‡å®š| E[é»˜è®¤: urllib]
    
    C --> F{urllib è·å–}
    D --> G{selenium è·å–}
    E --> F
    
    F -->|æˆåŠŸ| H[è¿”å›å†…å®¹]
    F -->|å¤±è´¥| I{è‡ªåŠ¨é™çº§?}
    I -->|æ˜¯| G
    I -->|å¦| J[è¿”å›é”™è¯¯]
    
    G -->|æˆåŠŸ| H
    G -->|å¤±è´¥| J
```

---

## 3. CLI å‚æ•°è®¾è®¡ / CLI Parameter Design

### 3.1 å‘½ä»¤è¡Œæ¥å£è§„èŒƒ / CLI Interface Specification

```bash
# åŸºç¡€ç”¨æ³• / Basic Usage
wf <url>                          # é»˜è®¤ï¼šè‡ªåŠ¨é€‰æ‹© (urllib â†’ selenium)
wf <url> --method urllib          # å¼ºåˆ¶ï¼šåªä½¿ç”¨ urllib
wf <url> --method selenium        # å¼ºåˆ¶ï¼šåªä½¿ç”¨ selenium

# ç®€å†™å½¢å¼ / Shorthand
wf <url> -m urllib               # ç­‰åŒäº --method urllib
wf <url> -m selenium             # ç­‰åŒäº --method selenium

# é«˜çº§é€‰é¡¹ / Advanced Options
wf <url> --no-fallback           # ç¦ç”¨è‡ªåŠ¨é™çº§
wf <url> --selenium-headless     # selenium æ— å¤´æ¨¡å¼
wf <url> --selenium-wait <sec>   # selenium ç­‰å¾…æ—¶é—´
```

### 3.2 å‚æ•°å®šä¹‰ / Parameter Definitions

```python
# CLI å‚æ•°æ¶æ„è§„èŒƒ / CLI Parameter Architecture
class CLIParameterSpec:
    """
    å‘½ä»¤è¡Œå‚æ•°è§„èŒƒå®šä¹‰ / CLI Parameter Specification
    """
    
    method_parameter = {
        "name": "--method",
        "short": "-m",
        "type": "choice",
        "choices": ["urllib", "selenium", "auto"],
        "default": "auto",
        "help": "é€‰æ‹©çˆ¬å–æ–¹å¼ (urllib/selenium/auto)"
    }
    
    fallback_parameter = {
        "name": "--no-fallback",
        "action": "store_true",
        "default": False,
        "help": "ç¦ç”¨å¤±è´¥æ—¶çš„è‡ªåŠ¨é™çº§"
    }
    
    selenium_options = {
        "--selenium-headless": "æ— å¤´æ¨¡å¼è¿è¡Œ Chrome",
        "--selenium-wait": "é¡µé¢åŠ è½½ç­‰å¾…æ—¶é—´(ç§’)",
        "--selenium-timeout": "æ€»è¶…æ—¶æ—¶é—´(ç§’)"
    }
```

### 3.3 ç”¨æˆ·äº¤äº’ç¤ºä¾‹ / User Interaction Examples

```bash
# åœºæ™¯1: è·å–é™æ€é¡µé¢ (urllib è¶³å¤Ÿ)
$ wf "https://example.com/api/data"
[INFO] Using urllib (default)
[SUCCESS] Content fetched in 0.5s

# åœºæ™¯2: éœ€è¦ JavaScript æ¸²æŸ“
$ wf "https://spa-app.com/dashboard"
[INFO] Using urllib (default)
[WARNING] urllib failed: No content found
[INFO] Auto-fallback to selenium
[SUCCESS] Content fetched in 3.2s

# åœºæ™¯3: ç”¨æˆ·æ˜ç¡®æŒ‡å®šselenium
$ wf "https://linkedin.com/in/profile" --method selenium
[INFO] Using selenium (user specified)
[SUCCESS] Content fetched in 2.8s

# åœºæ™¯4: ç¦ç”¨é™çº§ï¼Œå¿«é€Ÿå¤±è´¥
$ wf "https://protected.site" --method urllib --no-fallback
[INFO] Using urllib (user specified)
[ERROR] Failed: 403 Forbidden (no fallback)
```

---

## 4. å®æ–½è®¡åˆ’ / Implementation Plan

### âœ… å‰ç½®æ¡ä»¶ï¼šChrome Debugé…ç½® (å·²å®Œæˆ) / Prerequisites: Chrome Debug Configuration (COMPLETED)

```yaml
å®ŒæˆçŠ¶æ€: âœ… 100% å®Œæˆ
å®Œæˆæ—¥æœŸ: 2025-09-25

å·²å®Œæˆé¡¹ç›®:
  1. Chrome Debug.appåˆ›å»º:
     âœ… Automatoråº”ç”¨ä¿å­˜è‡³ /Applications/Chrome Debug.app
     âœ… å·²æ·»åŠ åˆ°Dockï¼Œæ”¯æŒä¸€é”®å¯åŠ¨
  
  2. chrome-debug.shè„šæœ¬ä¼˜åŒ–:
     âœ… æ™ºèƒ½å®ä¾‹ç®¡ç†ï¼Œé¿å…é‡å¤å¯åŠ¨Chromeè¿›ç¨‹
     âœ… è¿›ç¨‹æ£€æµ‹æœºåˆ¶ï¼šé¦–æ¬¡å¯åŠ¨debugå®ä¾‹ï¼Œåç»­ä»…å¼€æ–°æ ‡ç­¾
     âœ… AppleScriptæ§åˆ¶Chromeæ‰“å¼€æ–°æ ‡ç­¾é¡µ
     âœ… è°ƒè¯•ç«¯å£9222ï¼Œç‹¬ç«‹Profile: ~/.chrome-wf
  
  3. ç”¨æˆ·ä½“éªŒä¼˜åŒ–:
     âœ… é€æ˜çš„debugæ¨¡å¼å¯åŠ¨ä½“éªŒ
     âœ… èµ„æºå‹å¥½ï¼šé¿å…å¤šå®ä¾‹è¿è¡Œ
     âœ… æ”¯æŒURLå‚æ•°ä¼ é€’
  
  4. éªŒè¯æµ‹è¯•:
     âœ… Debugç«¯å£9222æ­£å¸¸å·¥ä½œ
     âœ… ä¸ºSeleniumæ¥ç®¡åšå¥½åŸºç¡€å‡†å¤‡

å½±å“:
  - Seleniumé›†æˆçš„å…³é”®åŸºç¡€è®¾æ–½å·²å°±ä½
  - æ¶ˆé™¤äº†Chromeé©±åŠ¨ç®¡ç†çš„æŠ€æœ¯éšœç¢
  - å¯ç«‹å³å¼€å§‹Seleniumæ’ä»¶å¼€å‘
```

### ç¬¬ä¸€é˜¶æ®µï¼šé…ç½®é©±åŠ¨çš„æ’ä»¶ç®¡ç† (0.5å¤©) / Phase 1: Configuration-Driven Plugin Management (0.5 day)

```yaml
ç›®æ ‡:
  - é€šè¿‡é…ç½®ç¦ç”¨éå¿…è¦æ’ä»¶ï¼ˆä¸åˆ é™¤ä»£ç ï¼‰
  - ä¿ç•™æ‰€æœ‰æ’ä»¶ä»£ç ä»¥ä¾¿æœªæ¥å¯ç”¨
  - å®ç°é…ç½®é©±åŠ¨çš„æ’ä»¶æ§åˆ¶æœºåˆ¶

å…·ä½“ä»»åŠ¡:
  1. åˆ›å»ºæ’ä»¶é…ç½®ç®¡ç†:
     - åˆ›å»º plugins/plugin_config.py
     - å®šä¹‰ ENABLED_PLUGINS = ['HTTPFetcherPlugin', 'SeleniumFetcherPlugin']
     - æ”¯æŒé€šè¿‡é…ç½®æ–‡ä»¶æˆ–ç¯å¢ƒå˜é‡æ§åˆ¶
  
  2. ä¿®æ”¹ plugin_registry.py:
     - æ·»åŠ é…ç½®æ£€æŸ¥é€»è¾‘
     - æ³¨å†Œæ—¶æ£€æŸ¥æ’ä»¶æ˜¯å¦åœ¨ ENABLED_PLUGINS ä¸­
     - ä¿ç•™æ‰€æœ‰æ’ä»¶ä»£ç ï¼Œä»…æ§åˆ¶æ³¨å†Œè¡Œä¸º
  
  3. ä¿æŒä»£ç å®Œæ•´æ€§:
     - ä¸åˆ é™¤ä»»ä½•ç°æœ‰æ’ä»¶æ–‡ä»¶
     - ä¿ç•™ curl.py, safari/, playwright.py ç­‰æ‰€æœ‰ä»£ç 
     - é€šè¿‡é…ç½®è€Œéåˆ é™¤æ¥å®ç°ç®€åŒ–

éªŒæ”¶æ ‡å‡†:
  - åªæœ‰ urllib å’Œ selenium å¯ç”¨ï¼ˆé€šè¿‡é…ç½®æ§åˆ¶ï¼‰
  - æ‰€æœ‰æ’ä»¶ä»£ç ä¿æŒå®Œæ•´
  - å¯é€šè¿‡ä¿®æ”¹é…ç½®é‡æ–°å¯ç”¨ä»»ä½•æ’ä»¶
```

### ç¬¬äºŒé˜¶æ®µï¼šSelenium é›†æˆ (1å¤©) / Phase 2: Selenium Integration (1 day)

```yaml
ç›®æ ‡:
  - å®ç° SeleniumFetcherPlugin
  - é›†æˆåˆ°æ’ä»¶ç³»ç»Ÿ
  - åˆ©ç”¨å·²é…ç½®çš„Chrome Debugç¯å¢ƒ

å…·ä½“ä»»åŠ¡:
  1. åˆ›å»º plugins/selenium/:
     - __init__.py
     - plugin.py (å®ç°æ¥å£)
     - config.py (é…ç½®)
  
  2. å®ç°æ ¸å¿ƒåŠŸèƒ½:
     âœ… Chrome Debugè¿æ¥ (ç«¯å£9222å·²å°±ç»ª)
     - ä½¿ç”¨selenium.webdriver.Chromeä¸debugç«¯å£è¿æ¥
     - é¡µé¢åŠ è½½ç­‰å¾…ç­–ç•¥
     - å†…å®¹æå–å’Œé”™è¯¯å¤„ç†
  
  3. Chromeé›†æˆä¼˜åŒ–:
     - è¿æ¥åˆ°è¿è¡Œä¸­çš„Chrome Debugå®ä¾‹
     - æ— éœ€é¢å¤–çš„ChromeDriverä¸‹è½½
     - å¤ç”¨å·²æœ‰çš„Chrome profileè®¾ç½®

éªŒæ”¶æ ‡å‡†:
  - Selenium æ’ä»¶å¯å·¥ä½œ
  - æˆåŠŸè¿æ¥Chrome Debugç«¯å£
  - æ”¯æŒåŸºç¡€é…ç½®é€‰é¡¹
```

### ç¬¬ä¸‰é˜¶æ®µï¼šCLI å‚æ•°å®ç° (0.5å¤©) / Phase 3: CLI Parameters (0.5 day)

```yaml
ç›®æ ‡:
  - æ·»åŠ  --method å‚æ•°
  - å®ç°é€‰æ‹©é€»è¾‘

å…·ä½“ä»»åŠ¡:
  1. ä¿®æ”¹ webfetcher.py:
     - æ·»åŠ  argparse å‚æ•°
     - å®ç°æ–¹æ³•é€‰æ‹©é€»è¾‘
  
  2. æ›´æ–° FetchContext:
     - æ·»åŠ  method å­—æ®µ
     - ä¼ é€’ç”¨æˆ·é€‰æ‹©

éªŒæ”¶æ ‡å‡†:
  - CLI å‚æ•°æ­£å¸¸å·¥ä½œ
  - å¯æ˜¾å¼é€‰æ‹©æ–¹æ³•
```

### ç¬¬å››é˜¶æ®µï¼šé™çº§é€»è¾‘ (0.5å¤©) / Phase 4: Fallback Logic (0.5 day)

```yaml
ç›®æ ‡:
  - å®ç°è‡ªåŠ¨é™çº§
  - æ·»åŠ  --no-fallback

å…·ä½“ä»»åŠ¡:
  1. ä¿®æ”¹è·å–é€»è¾‘:
     - urllib å¤±è´¥è‡ªåŠ¨å°è¯• selenium
     - éµå®ˆ --no-fallback æ ‡å¿—
  
  2. ä¼˜åŒ–æ—¥å¿—è¾“å‡º:
     - æ¸…æ™°æ˜¾ç¤ºä½¿ç”¨çš„æ–¹æ³•
     - è®°å½•é™çº§åŸå› 

éªŒæ”¶æ ‡å‡†:
  - é™çº§é“¾è·¯æ­£å¸¸å·¥ä½œ
  - ç”¨æˆ·å¯æ§åˆ¶é™çº§è¡Œä¸º
```

### ç¬¬äº”é˜¶æ®µï¼šæµ‹è¯•ä¸æ–‡æ¡£ (0.5å¤©) / Phase 5: Testing & Docs (0.5 day)

```yaml
ç›®æ ‡:
  - å®Œæ•´æµ‹è¯•è¦†ç›–
  - ç”¨æˆ·æ–‡æ¡£

å…·ä½“ä»»åŠ¡:
  1. ç¼–å†™æµ‹è¯•:
     - test_urllib_only.py
     - test_selenium_only.py
     - test_auto_fallback.py
  
  2. æ›´æ–°æ–‡æ¡£:
     - README ä½¿ç”¨è¯´æ˜
     - --help ä¿¡æ¯

éªŒæ”¶æ ‡å‡†:
  - æ‰€æœ‰æµ‹è¯•é€šè¿‡
  - æ–‡æ¡£æ¸…æ™°å®Œæ•´
```

**æ€»æ—¶é•¿**: 3å¤© (ç›¸æ¯”åŸæ–¹æ¡ˆçš„8å¤©ï¼ŒèŠ‚çœ62%æ—¶é—´)

---

## 5. æŠ€æœ¯è§„èŒƒ / Technical Specifications

### 5.1 æ’ä»¶æ¥å£ç®€åŒ– / Simplified Plugin Interface

```python
# ç»Ÿä¸€çš„æ’ä»¶æ¥å£ / Unified plugin interface
class SimplifiedFetcherPlugin:
    """
    ç®€åŒ–çš„çˆ¬å–æ’ä»¶æ¥å£ / Simplified fetcher plugin interface
    """
    
    # urllib å®ç°
    class UrllibFetcher(IFetcherPlugin):
        priority = FetchPriority.HIGH  # é»˜è®¤æœ€é«˜
        
        def fetch(self, url: str, context: FetchContext) -> FetchResult:
            # ä½¿ç”¨ urllib.request
            # å¤„ç†åŸºç¡€ HTTP/HTTPS
            # æ”¯æŒ headers, cookies
            pass
    
    # selenium å®ç°  
    class SeleniumFetcher(IFetcherPlugin):
        priority = FetchPriority.NORMAL  # é»˜è®¤æ™®é€š
        
        def fetch(self, url: str, context: FetchContext) -> FetchResult:
            # ä½¿ç”¨ selenium webdriver
            # å¤„ç† JavaScript æ¸²æŸ“
            # æ”¯æŒç­‰å¾…å’Œäº¤äº’
            pass
```

### 5.2 ä¼˜å…ˆçº§æ§åˆ¶é€»è¾‘ / Priority Control Logic

```python
# åŸºäºCLIå‚æ•°çš„ä¼˜å…ˆçº§è°ƒæ•´ / CLI-based priority adjustment
class PriorityController:
    """
    æ ¹æ®ç”¨æˆ·é€‰æ‹©è°ƒæ•´æ’ä»¶ä¼˜å…ˆçº§ / Adjust plugin priority per user choice
    """
    
    def adjust_priorities(self, method: str, plugins: List[IFetcherPlugin]):
        if method == "urllib":
            # urllib è®¾ä¸ºæœ€é«˜ï¼Œç¦ç”¨ selenium
            urllib_plugin.priority = FetchPriority.CRITICAL
            selenium_plugin.enabled = False
            
        elif method == "selenium":
            # selenium è®¾ä¸ºæœ€é«˜ï¼Œç¦ç”¨ urllib
            selenium_plugin.priority = FetchPriority.CRITICAL
            urllib_plugin.enabled = False
            
        elif method == "auto":
            # ä¿æŒé»˜è®¤ä¼˜å…ˆçº§
            urllib_plugin.priority = FetchPriority.HIGH
            selenium_plugin.priority = FetchPriority.NORMAL
```

---

## 6. é…ç½®é©±åŠ¨æ¶æ„ / Configuration-Driven Architecture

### 6.1 æ’ä»¶é…ç½®ç®¡ç†ç­–ç•¥ / Plugin Configuration Strategy

**æ ¸å¿ƒç†å¿µï¼šé€šè¿‡é…ç½®ç¦ç”¨ï¼Œè€Œéåˆ é™¤ä»£ç **

```python
# plugins/plugin_config.py - æ’ä»¶é…ç½®ä¸­å¿ƒ
class PluginConfig:
    """
    æ’ä»¶å¯ç”¨/ç¦ç”¨é…ç½®
    ä¿æŒæ‰€æœ‰æ’ä»¶ä»£ç ï¼Œä»…é€šè¿‡é…ç½®æ§åˆ¶è¡Œä¸º
    """
    
    # é»˜è®¤å¯ç”¨çš„æ’ä»¶ï¼ˆæç®€æ¨¡å¼ï¼‰
    ENABLED_PLUGINS = [
        'HTTPFetcherPlugin',      # urllibå®ç°
        'SeleniumFetcherPlugin'   # seleniumå®ç°
    ]
    
    # å¯ç”¨ä½†ç¦ç”¨çš„æ’ä»¶ï¼ˆä¿ç•™ä»£ç ï¼Œæœªæ¥å¯å¯ç”¨ï¼‰
    DISABLED_PLUGINS = [
        'CurlFetcherPlugin',       # ä¿ç•™ä»£ç ï¼Œé…ç½®ç¦ç”¨
        'SafariFetcherPlugin',     # ä¿ç•™ä»£ç ï¼Œé…ç½®ç¦ç”¨  
        'PlaywrightFetcherPlugin'  # ä¿ç•™ä»£ç ï¼Œé…ç½®ç¦ç”¨
    ]
    
    # æ”¯æŒç¯å¢ƒå˜é‡è¦†ç›–
    @classmethod
    def get_enabled_plugins(cls):
        import os
        env_plugins = os.getenv('WF_ENABLED_PLUGINS')
        if env_plugins:
            return env_plugins.split(',')
        return cls.ENABLED_PLUGINS
    
    # ç®¡ç†å‘˜æ¨¡å¼ï¼šé‡æ–°å¯ç”¨æ‰€æœ‰æ’ä»¶
    @classmethod
    def enable_all_plugins(cls):
        return cls.ENABLED_PLUGINS + cls.DISABLED_PLUGINS
```

### 6.2 é…ç½®åˆ‡æ¢æœºåˆ¶ / Configuration Switch Mechanism

```bash
# ç”¨æˆ·æ¨¡å¼ï¼ˆæç®€ï¼‰
export WF_ENABLED_PLUGINS="HTTPFetcherPlugin,SeleniumFetcherPlugin"

# å¼€å‘æ¨¡å¼ï¼ˆå¯ç”¨æ‰€æœ‰ï¼‰
export WF_ENABLED_PLUGINS="HTTPFetcherPlugin,SeleniumFetcherPlugin,CurlFetcherPlugin,SafariFetcherPlugin"

# æµ‹è¯•æ¨¡å¼ï¼ˆç‰¹å®šç»„åˆï¼‰
export WF_ENABLED_PLUGINS="HTTPFetcherPlugin,CurlFetcherPlugin"
```

### 6.3 æœ€å°åŒ–é…ç½® / Minimal Configuration

```python
# ç®€åŒ–çš„é…ç½®ç»“æ„ / Simplified configuration
class SimpleConfig:
    """
    åªä¿ç•™å¿…è¦çš„é…ç½®é¡¹ / Keep only essential configs
    """
    
    # å…¨å±€é…ç½®
    GLOBAL_CONFIG = {
        "default_method": "auto",      # auto/urllib/selenium
        "enable_fallback": True,        # æ˜¯å¦è‡ªåŠ¨é™çº§
        "timeout": 30,                  # å…¨å±€è¶…æ—¶(ç§’)
    }
    
    # urllib é…ç½®
    URLLIB_CONFIG = {
        "user_agent": "Mozilla/5.0...",
        "connect_timeout": 10,
        "read_timeout": 20,
    }
    
    # selenium é…ç½®
    SELENIUM_CONFIG = {
        "driver": "chrome",             # ä½¿ç”¨Chrome
        "headless": False,              # é»˜è®¤æœ‰å¤´æ¨¡å¼
        "wait_time": 10,                # é¡µé¢åŠ è½½ç­‰å¾…
        "window_size": "1920,1080",    
    }
```

### 6.2 ç¯å¢ƒå˜é‡æ”¯æŒ / Environment Variables

```bash
# é€šè¿‡ç¯å¢ƒå˜é‡è¦†ç›–é»˜è®¤é…ç½®
export WF_DEFAULT_METHOD=selenium      # é»˜è®¤ä½¿ç”¨selenium
export WF_SELENIUM_HEADLESS=true       # seleniumæ— å¤´æ¨¡å¼
export WF_TIMEOUT=60                   # 60ç§’è¶…æ—¶

# ä½¿ç”¨æ—¶è‡ªåŠ¨è¯»å–
wf "https://example.com"  # å°†ä½¿ç”¨ç¯å¢ƒå˜é‡ä¸­çš„é…ç½®
```

---

## 7. ğŸ¯ é£é™©è¯„ä¼°æ›´æ–° / Risk Assessment Update

### 7.1 æµ‹è¯•éªŒè¯åçš„é£é™©çŠ¶æ€ / Post-Validation Risk Status

**ğŸ† é‡å¤§é£é™©ç¼“è§£æˆæœ**: æµ‹è¯•éªŒè¯åï¼Œ90%çš„æŠ€æœ¯é£é™©å·²æ¶ˆé™¤ï¼

### 7.2 å·²å®Œå…¨æ¶ˆé™¤çš„é£é™© / Completely Eliminated Risks

```yaml
âœ… Chromeç¯å¢ƒé£é™© (åŸHIGHé£é™©):
  åŸå§‹é£é™©: Chromeé©±åŠ¨ç‰ˆæœ¬ä¸åŒ¹é…ã€ç¯å¢ƒé…ç½®å¤æ‚
  éªŒè¯ç»“æœ: âœ… å®Œå…¨æ¶ˆé™¤
  ç¼“è§£æªæ–½:
    - Chrome Debug.appå·²åˆ›å»ºå¹¶é€šè¿‡7ä¸ªç½‘ç«™éªŒè¯
    - è°ƒè¯•ç«¯å£9222ç¨³å®šè¿æ¥ï¼Œ100%æˆåŠŸç‡
    - webdriver-managerè‡ªåŠ¨å¤„ç†é©±åŠ¨ç‰ˆæœ¬
    - ç‹¬ç«‹Profileå®Œå…¨éš”ç¦»ï¼Œæ— ç¯å¢ƒå†²çª

âœ… æŠ€æœ¯å¯è¡Œæ€§é£é™© (åŸHIGHé£é™©):
  åŸå§‹é£é™©: Selenium + debuggerAddressæ–¹æ¡ˆå¯è¡Œæ€§ä¸ç¡®å®š
  éªŒè¯ç»“æœ: âœ… å®Œå…¨æ¶ˆé™¤
  æµ‹è¯•è¯æ®:
    - å¾®ä¿¡å…¬ä¼—å·(3.4MBå†…å®¹)æå–æˆåŠŸ
    - å°çº¢ä¹¦SPAåº”ç”¨å®Œç¾å¤„ç†
    - ç»´åŸºç™¾ç§‘å¤§å‹é¡µé¢æ— é—®é¢˜
    - JavaScriptæ‰§è¡Œèƒ½åŠ›éªŒè¯é€šè¿‡

âœ… ä¼šè¯å¤ç”¨é£é™© (åŸMEDIUMé£é™©):
  åŸå§‹é£é™©: ç™»å½•æ€ä¿æŒä¸ç¨³å®š
  éªŒè¯ç»“æœ: âœ… å®Œå…¨æ¶ˆé™¤
  éªŒè¯è¯æ®:
    - Cookieå’ŒLocalStorageæŒä¹…åŒ–ç¨³å®š
    - å¤šæ¬¡é‡è¿ä¿æŒç™»å½•çŠ¶æ€
    - æ— ç¼æ¥ç®¡Chromeå®ä¾‹
```

### 7.3 å‰©ä½™ä½é£é™©é¡¹ / Remaining Low-Risk Items

```yaml
âš ï¸ å®æ–½é£é™© (LOW):
  - Seleniumæ’ä»¶å¼€å‘å¯èƒ½é‡åˆ°APIå˜æ›´
  - é¢„è®¡å½±å“: ä½ï¼Œæœ‰æ ‡å‡†APIæ¥å£
  - ç¼“è§£æªæ–½: ä½¿ç”¨æˆç†Ÿçš„Selenium WebDriver

âš ï¸ è¿ç»´é£é™© (LOW):
  - ç”¨æˆ·å¯èƒ½å¿˜è®°å¯åŠ¨Chrome Debug
  - é¢„è®¡å½±å“: ä½ï¼Œæœ‰æ˜ç¡®é”™è¯¯æç¤º
  - ç¼“è§£æªæ–½: ä¼˜é›…é™çº§åˆ°urllibï¼Œç”¨æˆ·æŒ‡å¯¼æ–‡æ¡£
```

### 7.4 é£é™©è¯„åˆ†å¯¹æ¯” / Risk Score Comparison

| é£é™©ç±»å‹ | éªŒè¯å‰è¯„åˆ† | éªŒè¯åè¯„åˆ† | å˜åŒ– |
|---------|------------|------------|------|
| æŠ€æœ¯å¯è¡Œæ€§ | 80/100 (HIGH) | 10/100 (LOW) | â¬‡ï¸ -70 |
| Chromeç¯å¢ƒ | 70/100 (HIGH) | 5/100 (LOW) | â¬‡ï¸ -65 |
| ä¼šè¯ç®¡ç† | 50/100 (MED) | 10/100 (LOW) | â¬‡ï¸ -40 |
| æ€§èƒ½å½±å“ | 40/100 (MED) | 15/100 (LOW) | â¬‡ï¸ -25 |
| **ç»¼åˆé£é™©** | **60/100** | **12/100** | **â¬‡ï¸ -48** |

**ğŸ‰ é£é™©çŠ¶æ€**: ä» **ä¸­ç­‰é£é™©** é™çº§ä¸º **æä½é£é™©**

### 7.5 æµ‹è¯•è¯æ®æ”¯æ’‘ / Test Evidence Support

- **ğŸ“Š æˆåŠŸç‡**: 100% (7/7 ç½‘ç«™ç±»å‹)
- **âš¡ æ€§èƒ½**: å¹³å‡4.19ç§’å“åº”ï¼Œæ»¡è¶³ç”Ÿäº§è¦æ±‚
- **ğŸ”§ ç¨³å®šæ€§**: Chrome Debugè¿æ¥é›¶ä¸­æ–­
- **ğŸŒ è¦†ç›–åº¦**: ä»é™æ€åˆ°åŠ¨æ€ã€ä»ç®€å•åˆ°å¤æ‚å…¨è¦†ç›–
- **ğŸ’¾ ä¼šè¯**: ç™»å½•æ€å®Œç¾ä¿æŒï¼Œæ— çŠ¶æ€ä¸¢å¤±
```

### 7.3 ä¸‹ä¸€æ­¥è¡ŒåŠ¨ä¼˜å…ˆçº§ / Next Action Priorities

```yaml
é«˜ä¼˜å…ˆçº§ (ç«‹å³æ‰§è¡Œ):
  1. ç¦ç”¨éå¿…è¦æ’ä»¶ï¼Œç®€åŒ–ç³»ç»Ÿ
  2. å®ç°SeleniumåŸºç¡€æ’ä»¶æ¡†æ¶
  3. éªŒè¯Chrome Debugè¿æ¥

ä¸­ä¼˜å…ˆçº§ (1-2å¤©å†…):
  1. å®ç°CLIå‚æ•°ç³»ç»Ÿ
  2. æ·»åŠ è‡ªåŠ¨é™çº§é€»è¾‘
  3. ç¼–å†™é›†æˆæµ‹è¯•

ä½ä¼˜å…ˆçº§ (å¯å»¶å):
  1. Headlessæ¨¡å¼æ”¯æŒ
  2. é«˜çº§é…ç½®é€‰é¡¹
  3. æ€§èƒ½ä¼˜åŒ–
```

## 8. æµ‹è¯•æ–¹æ¡ˆ / Test Plan

### 8.1 æ ¸å¿ƒæµ‹è¯•ç”¨ä¾‹ / Core Test Cases

```python
# ç®€åŒ–çš„æµ‹è¯•åœºæ™¯ / Simplified test scenarios
class TestScenarios:
    """
    è¦†ç›–äºŒé€‰ä¸€æ¶æ„çš„æ‰€æœ‰åœºæ™¯ / Cover all binary architecture scenarios
    """
    
    def test_urllib_success():
        """urllib æˆåŠŸè·å–é™æ€é¡µé¢"""
        result = wf("https://httpbin.org/html", method="urllib")
        assert result.success
        assert result.method_used == "urllib"
    
    def test_selenium_javascript():
        """selenium å¤„ç†JavaScriptæ¸²æŸ“"""
        result = wf("https://example-spa.com", method="selenium")
        assert result.success
        assert result.method_used == "selenium"
    
    def test_auto_fallback():
        """è‡ªåŠ¨é™çº§: urllibå¤±è´¥ â†’ selenium"""
        result = wf("https://js-heavy-site.com")  # é»˜è®¤auto
        assert result.success
        assert result.method_used == "selenium"
        assert "fallback" in result.logs
    
    def test_no_fallback_fail():
        """ç¦ç”¨é™çº§æ—¶çš„å¤±è´¥"""
        result = wf("https://js-site.com", 
                   method="urllib", 
                   no_fallback=True)
        assert not result.success
        assert result.error == "urllib failed, no fallback"
```

### 8.2 æ€§èƒ½åŸºå‡† / Performance Benchmarks

```yaml
æ€§èƒ½æŒ‡æ ‡:
  urllib:
    é™æ€é¡µé¢: < 0.5ç§’
    APIå“åº”: < 0.3ç§’
    å¤§æ–‡ä»¶: < 2ç§’
  
  selenium:
    ç®€å•é¡µé¢: < 3ç§’
    å¤æ‚SPA: < 5ç§’
    ç™»å½•æµç¨‹: < 10ç§’
  
  è‡ªåŠ¨é™çº§:
    æ£€æµ‹æ—¶é—´: < 0.1ç§’
    åˆ‡æ¢å¼€é”€: < 0.5ç§’
```

---

## 8. ç”¨æˆ·æŒ‡å— / User Guide

### 8.1 å¿«é€Ÿå¼€å§‹ / Quick Start

```bash
# å®‰è£…ä¾èµ–
pip install selenium webdriver-manager  # å¦‚éœ€seleniumæ”¯æŒ

# åŸºæœ¬ä½¿ç”¨
wf "https://example.com"               # è‡ªåŠ¨é€‰æ‹©æœ€ä½³æ–¹å¼
wf "https://spa.com" -m selenium       # å¼ºåˆ¶ä½¿ç”¨selenium
wf "https://api.com/data" -m urllib    # å¼ºåˆ¶ä½¿ç”¨urllib

# æŸ¥çœ‹å¸®åŠ©
wf --help
```

### 8.2 å¸¸è§åœºæ™¯æŒ‡å— / Common Scenarios

| åœºæ™¯ / Scenario | æ¨èæ–¹å¼ / Recommended | å‘½ä»¤ç¤ºä¾‹ / Command |
|---|---|---|
| REST API | urllib | `wf "api.com/data" -m urllib` |
| é™æ€HTML | urllib | `wf "blog.com/post"` |
| SPAåº”ç”¨ | selenium | `wf "app.com" -m selenium` |
| éœ€è¦ç™»å½• | selenium | `wf "site.com" -m selenium` |
| ä¸ç¡®å®š | auto | `wf "site.com"` |

### 8.3 æ•…éšœæ’æŸ¥ / Troubleshooting

```yaml
å¸¸è§é—®é¢˜:
  urllibå¤±è´¥:
    - æ£€æŸ¥URLæ˜¯å¦éœ€è¦JavaScript
    - å°è¯•: wf <url> -m selenium
  
  seleniumå¤±è´¥:
    - ç¡®ä¿Chromeå·²å®‰è£…
    - æ£€æŸ¥: chrome --version
    - å®‰è£…é©±åŠ¨: pip install webdriver-manager
  
  éƒ½å¤±è´¥:
    - æ£€æŸ¥ç½‘ç»œè¿æ¥
    - æŸ¥çœ‹è¯¦ç»†æ—¥å¿—: wf <url> --verbose
```

---

## 9. è¿ç§»è®¡åˆ’ / Migration Plan

### 9.1 ä»ç°æœ‰æ¶æ„è¿ç§» / Migration from Current Architecture

```yaml
å‡†å¤‡é˜¶æ®µ (Day 0):
  - å¤‡ä»½ç°æœ‰é…ç½®
  - è®°å½•å½“å‰æ’ä»¶çŠ¶æ€
  - å‡†å¤‡å›æ»šè„šæœ¬

å®æ–½é˜¶æ®µ (Day 1-3):
  Day 1:
    - ç¦ç”¨éæ ¸å¿ƒæ’ä»¶
    - ä¿ç•™urllibåŠŸèƒ½
    - æµ‹è¯•åŸºç¡€åŠŸèƒ½
  
  Day 2:
    - é›†æˆselenium
    - å®ç°CLIå‚æ•°
    - å†…éƒ¨æµ‹è¯•
  
  Day 3:
    - å®Œå–„é™çº§é€»è¾‘
    - æ€§èƒ½ä¼˜åŒ–
    - æ–‡æ¡£æ›´æ–°

éªŒè¯é˜¶æ®µ (Day 4):
  - å…¨é¢æµ‹è¯•
  - æ€§èƒ½å¯¹æ¯”
  - ç”¨æˆ·åé¦ˆ
```

### 9.2 ç®€åŒ–çš„å›æ»šæ–¹æ¡ˆ / Simplified Rollback

```bash
#!/bin/bash
# ä¸€é”®å›æ»šåˆ°ç®€åŒ–æ¶æ„ä¹‹å‰çš„çŠ¶æ€
rollback_simplified() {
    # 1. æ¢å¤æ‰€æœ‰æ’ä»¶
    git checkout -- plugins/registry.py
    
    # 2. ç§»é™¤CLIå‚æ•°
    git checkout -- webfetcher.py
    
    # 3. åˆ é™¤seleniumæ’ä»¶
    rm -rf plugins/selenium/
    
    echo "å·²å›æ»šåˆ°åŸå§‹å¤šæ’ä»¶æ¶æ„"
}

# æˆ–è€…å‰è¿›åˆ°çº¯urllibæ¨¡å¼
forward_to_urllib_only() {
    # 1. ç¦ç”¨selenium
    echo "enabled = False" > plugins/selenium/config.py
    
    # 2. è®¾ç½®é»˜è®¤æ–¹æ³•
    export WF_DEFAULT_METHOD=urllib
    
    echo "å·²åˆ‡æ¢åˆ°çº¯urllibæ¨¡å¼"
}
```

---

## 10. æ¶æ„å†³ç­–è®°å½• / Architecture Decision Record

### 10.0 ä¸ºä»€ä¹ˆé…ç½®é©±åŠ¨è€Œéåˆ é™¤ä»£ç  / Why Configuration-Driven Instead of Code Deletion

```python
configuration_driven_rationale = {
    "ä¿ç•™ä»£ç çš„ç†ç”±": {
        "å¯é€†æ€§": "éšæ—¶å¯é€šè¿‡é…ç½®é‡æ–°å¯ç”¨ä»»ä½•æ’ä»¶",
        "ç»´æŠ¤æ€§": "ä»£ç å®Œæ•´æ€§æœ‰åŠ©äºç†è§£ç³»ç»Ÿå…¨è²Œ",
        "çµæ´»æ€§": "ä¸åŒç¯å¢ƒå¯ä½¿ç”¨ä¸åŒæ’ä»¶ç»„åˆ",
        "é£é™©é™ä½": "é¿å…åˆ é™¤ä»£ç å¯¼è‡´çš„ä¸å¯é€†æŸå¤±"
    },
    
    "é…ç½®é©±åŠ¨çš„ä¼˜åŠ¿": {
        "ç”¨æˆ·ä½“éªŒ": "ç”¨æˆ·åªçœ‹åˆ°å¯ç”¨çš„æ’ä»¶ï¼ˆurllib/seleniumï¼‰",
        "å¼€å‘ä½“éªŒ": "å¼€å‘è€…å¯ä»¥å¿«é€Ÿåˆ‡æ¢å’Œæµ‹è¯•ä¸åŒç»„åˆ",
        "éƒ¨ç½²çµæ´»": "é€šè¿‡ç¯å¢ƒå˜é‡æ§åˆ¶ä¸åŒéƒ¨ç½²çš„è¡Œä¸º",
        "å›æ»šç®€å•": "åªéœ€ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œæ— éœ€æ¢å¤ä»£ç "
    },
    
    "å®æ–½ç­–ç•¥": {
        "ç¬¬ä¸€é˜¶æ®µ": "åˆ›å»ºé…ç½®ç®¡ç†æœºåˆ¶",
        "ç¬¬äºŒé˜¶æ®µ": "ä¿®æ”¹æ³¨å†Œé€»è¾‘è¯»å–é…ç½®",
        "ç¬¬ä¸‰é˜¶æ®µ": "ä¿æŒæ‰€æœ‰æ’ä»¶ä»£ç å®Œæ•´",
        "é•¿æœŸç»´æŠ¤": "é€šè¿‡é…ç½®è€Œéä»£ç ç®¡ç†åŠŸèƒ½"
    }
}
```

### 10.1 ä¸ºä»€ä¹ˆç®€åŒ–åˆ°äºŒé€‰ä¸€ / Why Simplify to Binary Choice

```python
decision_rationale = {
    "ç®€åŒ–ç†ç”±": {
        "å¤æ‚åº¦é™ä½": "ä»5+æ’ä»¶åˆ°2ä¸ªï¼Œé™ä½80%å¤æ‚åº¦",
        "ç”¨æˆ·ä½“éªŒ": "æ¸…æ™°çš„äºŒé€‰ä¸€ï¼Œæ— éœ€ç†è§£å¤æ‚ä¼˜å…ˆçº§",
        "ç»´æŠ¤æˆæœ¬": "ä»£ç é‡å‡å°‘60%ï¼Œç»´æŠ¤æ›´å®¹æ˜“",
        "è¦†ç›–åº¦": "urllib+seleniumè¦†ç›–95%+ä½¿ç”¨åœºæ™¯"
    },
    
    "ä¸ºä»€ä¹ˆæ˜¯urllib+selenium": {
        "urllib": {
            "ä¼˜åŠ¿": "Pythonå†…ç½®ã€é›¶ä¾èµ–ã€å¿«é€Ÿã€ç¨³å®š",
            "åœºæ™¯": "è¦†ç›–70%çš„é™æ€å†…å®¹è·å–"
        },
        "selenium": {
            "ä¼˜åŠ¿": "å¤„ç†JavaScriptã€ç™»å½•æ€ã€åŠ¨æ€å†…å®¹",
            "åœºæ™¯": "è¦†ç›–å‰©ä½™30%çš„å¤æ‚åœºæ™¯"
        }
    },
    
    "ä¸ºä»€ä¹ˆä¸è¦å…¶ä»–æ’ä»¶": {
        "Curl": "åŠŸèƒ½ä¸urllibé‡å ï¼Œå¢åŠ å¤æ‚åº¦",
        "Playwright": "è¿‡äºå¤æ‚ï¼Œseleniumè¶³å¤Ÿ",
        "Safari": "å¹³å°ç‰¹å®šï¼Œé€šç”¨æ€§å·®"
    }
}
```

### 10.2 è®¾è®¡åŸåˆ™éªŒè¯ / Design Principle Validation

âœ… **æç®€ä¸»ä¹‰**: åªä¿ç•™ä¸¤ä¸ªå¿…è¦é€‰é¡¹  
âœ… **ç”¨æˆ·æ§åˆ¶**: CLIå‚æ•°æä¾›æ˜ç¡®æ§åˆ¶  
âœ… **æ¸è¿›å®æ–½**: 3å¤©å®ŒæˆvsåŸ8å¤©è®¡åˆ’  
âœ… **å‘åå…¼å®¹**: å¯éšæ—¶å›æ»šåˆ°åŸæ¶æ„  
âœ… **æ¸…æ™°æ„å›¾**: urllib/seleniumåç§°è‡ªè§£é‡Š  
âœ… **åŠ¡å®é€‰æ‹©**: åŸºäºå®é™…ä½¿ç”¨ç»Ÿè®¡çš„å†³ç­–  

---

## 11. å®æ–½è¿›åº¦è·Ÿè¸ª / Implementation Progress Tracking

### âœ… å·²å®Œæˆä»»åŠ¡ / Completed Tasks

```bash
# Chrome Debugç¯å¢ƒé…ç½® (100% å®Œæˆ)
âœ… åˆ›å»º Chrome Debug.app åº”ç”¨
âœ… ä¼˜åŒ– chrome-debug.sh è„šæœ¬
âœ… é…ç½®è°ƒè¯•ç«¯å£9222
âœ… éªŒè¯Chrome debugæ¨¡å¼æ­£å¸¸å·¥ä½œ
```

### ğŸ”„ è¿›è¡Œä¸­ä»»åŠ¡ / In Progress Tasks

```bash
# 1. ç¦ç”¨å¤šä½™æ’ä»¶ (30åˆ†é’Ÿ)
- [ ] ç¼–è¾‘ plugins/registry.py
- [ ] æ³¨é‡Šæ‰ Curl, Safari, Playwright æ’ä»¶
- [ ] æµ‹è¯• urllib ä»æ­£å¸¸å·¥ä½œ

# 2. åˆ›å»ºseleniumæ’ä»¶ (2å°æ—¶)  
- [ ] mkdir plugins/selenium
- [ ] åˆ›å»º plugin.py å®ç° IFetcherPlugin
- [ ] è¿æ¥Chrome Debugç«¯å£9222

# 3. æ·»åŠ CLIå‚æ•° (1å°æ—¶)
- [ ] ä¿®æ”¹ webfetcher.py æ·»åŠ  --method
- [ ] å®ç°å‚æ•°è§£æå’Œä¼ é€’
- [ ] æ›´æ–° --help ä¿¡æ¯

# 4. å®ç°é™çº§é€»è¾‘ (1å°æ—¶)
- [ ] æ·»åŠ  try-except é™çº§é“¾
- [ ] æ·»åŠ  --no-fallback æ”¯æŒ
- [ ] å®Œå–„æ—¥å¿—è¾“å‡º

# 5. ç¼–å†™æµ‹è¯• (1å°æ—¶)
- [ ] test_method_selection.py
- [ ] test_fallback.py
- [ ] è¿è¡Œå¹¶é€šè¿‡æ‰€æœ‰æµ‹è¯•
```

### å¾…æ‰§è¡Œä»»åŠ¡ / Pending Tasks

```bash
# 1. Seleniumä¸Chrome Debugé›†æˆ
- [ ] å®ç°è¿œç¨‹è°ƒè¯•è¿æ¥é€»è¾‘
- [ ] æµ‹è¯•Chromeå®ä¾‹å¤ç”¨
- [ ] éªŒè¯æ ‡ç­¾é¡µç®¡ç†

# 2. ä¼˜åŒ–seleniumé…ç½®
- [ ] æ·»åŠ headlessæ¨¡å¼é€‰é¡¹ï¼ˆå¯é€‰ï¼ŒDebugæ¨¡å¼å·²å¯ç”¨ï¼‰
- [ ] å®ç°waitç­–ç•¥
- [ ] å¤„ç†è¶…æ—¶

# 2. å®Œå–„æ–‡æ¡£
- [ ] æ›´æ–° README
- [ ] ç¼–å†™ä½¿ç”¨ç¤ºä¾‹
- [ ] å½•åˆ¶æ¼”ç¤ºè§†é¢‘
```

### äº¤ä»˜æ ‡å‡† / Delivery Criteria

âœ… `wf url` æ­£å¸¸å·¥ä½œ  
âœ… `wf url -m urllib` å¼ºåˆ¶urllib  
âœ… `wf url -m selenium` å¼ºåˆ¶selenium  
âœ… è‡ªåŠ¨é™çº§æ­£ç¡®è§¦å‘  
âœ… æ‰€æœ‰æµ‹è¯•é€šè¿‡

---

## 12. è¯¦ç»†å®æ–½è·¯çº¿å›¾ / Detailed Implementation Roadmap

> **åŸºäºæµ‹è¯•éªŒè¯æˆåŠŸçš„æŠ€æœ¯æ–¹æ¡ˆï¼Œæä¾›ç²¾ç¡®åˆ°ä»£ç ä½ç½®çš„å®æ–½æŒ‡å—**  
> **çŠ¶æ€**: æŠ€æœ¯éªŒè¯å®Œæˆï¼Œå‡†å¤‡æ­£å¼å¼€å‘  
> **é¢„ä¼°æ—¶é—´**: 2-3ä¸ªå·¥ä½œæ—¥  

### 12.1 é¡¹ç›®æ–‡ä»¶ç»“æ„è§„åˆ’ / Project Structure Planning

#### 12.1.1 éœ€è¦åˆ›å»ºçš„æ–°ç›®å½•å’Œæ–‡ä»¶ / New Directories and Files

```yaml
æ–°å¢ç›®å½•ç»“æ„:
  plugins/selenium/:                    # Seleniumæ’ä»¶ç›®å½•
    â”œâ”€â”€ __init__.py                    # æ¨¡å—åˆå§‹åŒ–ï¼Œå¯¼å‡ºSeleniumFetcherPlugin
    â”œâ”€â”€ plugin.py                      # æ ¸å¿ƒæ’ä»¶å®ç°ï¼Œç»§æ‰¿IFetcherPlugin
    â”œâ”€â”€ config.py                      # æ’ä»¶é…ç½®ï¼šè¶…æ—¶ã€ç­‰å¾…ç­–ç•¥ç­‰
    â””â”€â”€ chrome_manager.py              # Chrome Debugè¿æ¥ç®¡ç†å™¨

  tests/integration/:                   # é›†æˆæµ‹è¯•ç›®å½•
    â”œâ”€â”€ test_urllib_selenium.py        # urllib/seleniumé›†æˆæµ‹è¯•
    â”œâ”€â”€ test_fallback_logic.py         # é™çº§é€»è¾‘æµ‹è¯•
    â””â”€â”€ test_cli_parameters.py         # CLIå‚æ•°æµ‹è¯•

æ–‡ä»¶å‘½åè§„èŒƒ:
  - æ’ä»¶æ–‡ä»¶: å°å†™ä¸‹åˆ’çº¿å‘½å (selenium_plugin.py)
  - æµ‹è¯•æ–‡ä»¶: test_å‰ç¼€ (test_selenium.py)
  - é…ç½®æ–‡ä»¶: config.py ç»Ÿä¸€å‘½å
```

#### 12.1.2 éœ€è¦ä¿®æ”¹çš„ç°æœ‰æ–‡ä»¶æ¸…å• / Existing Files to Modify

```yaml
æ ¸å¿ƒä¿®æ”¹æ–‡ä»¶:
  1. webfetcher.py:
     - æ·»åŠ  --method å‚æ•°æ”¯æŒ
     - ä¿®æ”¹ fetch_html() å‡½æ•°è°ƒç”¨é€»è¾‘
     - é›†æˆé™çº§å¤„ç†æœºåˆ¶

  2. plugins/registry.py:
     - æ³¨é‡Š/ç¦ç”¨å¤šä½™æ’ä»¶æ³¨å†Œ
     - æ·»åŠ Seleniumæ’ä»¶æ³¨å†Œ
     - å®ç°ä¼˜å…ˆçº§åŠ¨æ€è°ƒæ•´

  3. plugins/base.py:
     - æ‰©å±•FetchContextæ·»åŠ methodå­—æ®µ
     - å¢å¼ºFetchResulté”™è¯¯ä¿¡æ¯

  4. parsers.py:
     - ç¡®ä¿ä¸æ–°æ’ä»¶ç³»ç»Ÿå…¼å®¹
     - æ— éœ€å¤§æ”¹ï¼Œä»…éªŒè¯æ¥å£

å¯é€‰ä¿®æ”¹æ–‡ä»¶:
  - plugins/http_fetcher.py: ä¼˜åŒ–é”™è¯¯å¤„ç†
  - core/downloader.py: é›†æˆä¸‹è½½åŠŸèƒ½ï¼ˆå¦‚éœ€è¦ï¼‰
```

### 12.2 ä»£ç ä¿®æ”¹è¯¦ç»†ä½ç½® / Detailed Code Modification Points

#### 12.2.1 webfetcher.py ä¿®æ”¹ç‚¹ / webfetcher.py Modifications

```python
# ä½ç½®1: è¡Œå· 4815-4845 (mainå‡½æ•°ä¸­çš„ArgumentParseréƒ¨åˆ†)
ä¿®æ”¹ç›®æ ‡: æ·»åŠ  --method å‚æ•°
ä¿®æ”¹æ–¹å¼:
  åœ¨ line 4831 åæ·»åŠ :
    ap.add_argument('--method', '-m', 
                    choices=['auto', 'urllib', 'selenium'],
                    default='auto',
                    help='Choose fetching method (auto/urllib/selenium)')
    ap.add_argument('--no-fallback', 
                    action='store_true',
                    help='Disable automatic fallback on failure')

# ä½ç½®2: è¡Œå· 1155-1200 (fetch_html_with_pluginså‡½æ•°)
ä¿®æ”¹ç›®æ ‡: é›†æˆmethodé€‰æ‹©é€»è¾‘
ä¿®æ”¹æ–¹å¼:
  1. å‡½æ•°ç­¾åæ·»åŠ  method å‚æ•°
  2. åœ¨å‡½æ•°å¼€å§‹å¤„æ·»åŠ ä¼˜å…ˆçº§è°ƒæ•´é€»è¾‘:
     if method == 'urllib':
         registry.set_plugin_priority('HTTPFetcherPlugin', FetchPriority.CRITICAL)
         registry.disable_plugin('SeleniumFetcherPlugin')
     elif method == 'selenium':
         registry.set_plugin_priority('SeleniumFetcherPlugin', FetchPriority.CRITICAL)
         registry.disable_plugin('HTTPFetcherPlugin')

# ä½ç½®3: è¡Œå· 4900-4950 (mainå‡½æ•°çš„URLå¤„ç†éƒ¨åˆ†)
ä¿®æ”¹ç›®æ ‡: ä¼ é€’methodå‚æ•°åˆ°fetchå‡½æ•°
ä¿®æ”¹æ–¹å¼:
  ä¿®æ”¹fetchè°ƒç”¨ï¼Œæ·»åŠ methodå‚æ•°:
    html_content, metrics = fetch_html_with_plugins(
        url=url,
        ua=user_agent,
        timeout=args.timeout,
        method=args.method,
        no_fallback=args.no_fallback
    )
```

#### 12.2.2 plugins/registry.py ä¿®æ”¹ç‚¹ / registry.py Modifications

```python
# ä½ç½®1: è¡Œå· 100-150 (register_pluginsæ–¹æ³•åŒºåŸŸ)
ä¿®æ”¹ç›®æ ‡: é€šè¿‡é…ç½®æ§åˆ¶æ’ä»¶æ³¨å†Œï¼ˆä¿ç•™æ‰€æœ‰ä»£ç ï¼‰
ä¿®æ”¹æ–¹å¼:
  1. æ·»åŠ é…ç½®å¯¼å…¥ï¼ˆä¸åˆ é™¤ä»»ä½•æ’ä»¶å¯¼å…¥ï¼‰:
     from .plugin_config import ENABLED_PLUGINS
  
  2. ä¿®æ”¹æ³¨å†Œé€»è¾‘ï¼ˆä¿ç•™æ‰€æœ‰æ’ä»¶ä»£ç ï¼‰:
     # æ‰€æœ‰æ’ä»¶ä¾ç„¶å¯¼å…¥ï¼Œä½†é€šè¿‡é…ç½®æ§åˆ¶æ³¨å†Œ
     plugins_map = {
         'HTTPFetcherPlugin': HTTPFetcherPlugin(),
         'CurlFetcherPlugin': CurlFetcherPlugin(),
         'SafariFetcherPlugin': SafariFetcherPlugin(),
         'PlaywrightFetcherPlugin': PlaywrightFetcherPlugin(),
         'SeleniumFetcherPlugin': SeleniumFetcherPlugin()
     }
     
     # åªæ³¨å†Œå¯ç”¨çš„æ’ä»¶
     for plugin_name in ENABLED_PLUGINS:
         if plugin_name in plugins_map:
             self.register(plugins_map[plugin_name])

# ä½ç½®2: æ·»åŠ æ–°æ–¹æ³• (è¡Œå· 180 é™„è¿‘)
ä¿®æ”¹ç›®æ ‡: æ·»åŠ åŠ¨æ€ä¼˜å…ˆçº§è°ƒæ•´æ–¹æ³•
æ–°å¢ä»£ç :
  def set_plugin_priority(self, plugin_name: str, priority: FetchPriority):
      """åŠ¨æ€è°ƒæ•´æ’ä»¶ä¼˜å…ˆçº§"""
      if plugin_name in self._plugins:
          self._plugins[plugin_name].priority = priority
          self._sort_plugins()
  
  def disable_plugin(self, plugin_name: str):
      """ä¸´æ—¶ç¦ç”¨æ’ä»¶"""
      if plugin_name in self._plugins:
          self._plugins[plugin_name].enabled = False
```

#### 12.2.3 plugins/base.py ä¿®æ”¹ç‚¹ / base.py Modifications

```python
# ä½ç½®1: è¡Œå· 22-35 (FetchContextç±»å®šä¹‰)
ä¿®æ”¹ç›®æ ‡: æ·»åŠ methodå­—æ®µæ”¯æŒ
ä¿®æ”¹æ–¹å¼:
  åœ¨FetchContextç±»ä¸­æ·»åŠ :
    method: Optional[str] = None  # 'auto', 'urllib', 'selenium'
    no_fallback: bool = False     # æ˜¯å¦ç¦ç”¨è‡ªåŠ¨é™çº§

# ä½ç½®2: è¡Œå· 35-50 (FetchResultç±»å®šä¹‰)
ä¿®æ”¹ç›®æ ‡: å¢å¼ºé”™è¯¯ä¿¡æ¯
ä¿®æ”¹æ–¹å¼:
  åœ¨FetchResultç±»ä¸­æ·»åŠ :
    fallback_used: bool = False   # æ˜¯å¦ä½¿ç”¨äº†é™çº§
    original_error: Optional[str] = None  # åŸå§‹é”™è¯¯ä¿¡æ¯
```

### 12.3 æ–°å¢ä»£ç æ¨¡å—è®¾è®¡ / New Code Module Design

#### 12.3.0 æ’ä»¶é…ç½®ç®¡ç†å™¨ / Plugin Configuration Manager

```python
# æ–‡ä»¶: plugins/plugin_config.py (æ–°å¢)
# æ¶æ„è§„èŒƒï¼šé…ç½®é©±åŠ¨çš„æ’ä»¶æ§åˆ¶

class PluginConfigManager:
    """
    æ’ä»¶é…ç½®ç®¡ç†å™¨ - æ§åˆ¶æ’ä»¶å¯ç”¨/ç¦ç”¨è€Œä¸åˆ é™¤ä»£ç 
    """
    
    æ ¸å¿ƒé…ç½®:
      ENABLED_PLUGINS: å¯ç”¨çš„æ’ä»¶åˆ—è¡¨
      DISABLED_PLUGINS: ä¿ç•™ä½†ç¦ç”¨çš„æ’ä»¶
      
    è®¾è®¡åŸåˆ™:
      - æ‰€æœ‰æ’ä»¶ä»£ç ä¿æŒå®Œæ•´
      - é€šè¿‡é…ç½®æ§åˆ¶è¿è¡Œæ—¶è¡Œä¸º
      - æ”¯æŒåŠ¨æ€åˆ‡æ¢å’Œé‡è½½
      - ç¯å¢ƒå˜é‡è¦†ç›–æœºåˆ¶
    
    æ–¹æ³•:
      - is_plugin_enabled(name): æ£€æŸ¥æ’ä»¶æ˜¯å¦å¯ç”¨
      - enable_plugin(name): åŠ¨æ€å¯ç”¨æ’ä»¶
      - disable_plugin(name): åŠ¨æ€ç¦ç”¨æ’ä»¶
      - reload_config(): é‡æ–°åŠ è½½é…ç½®
      - get_active_plugins(): è·å–å½“å‰æ´»åŠ¨æ’ä»¶åˆ—è¡¨
```

### 12.3 æ–°å¢ä»£ç æ¨¡å—è®¾è®¡ï¼ˆç»­ï¼‰ / New Code Module Design (continued)

#### 12.3.1 Seleniumæ’ä»¶å®ç° / Selenium Plugin Implementation

```python
# æ–‡ä»¶: plugins/selenium/plugin.py
# æ¶æ„è§„èŒƒï¼ˆä¸å®ç°å…·ä½“ä»£ç ï¼‰:

class SeleniumFetcherPlugin(BaseFetcherPlugin):
    """
    Seleniumçˆ¬å–æ’ä»¶å®ç°è§„èŒƒ
    """
    
    åç§°: "SeleniumFetcherPlugin"
    ä¼˜å…ˆçº§: FetchPriority.NORMAL
    
    æ ¸å¿ƒæ–¹æ³•:
      - __init__(): åˆå§‹åŒ–Chromeé€‰é¡¹å’Œè¿æ¥å‚æ•°
      - can_handle(url, context): åˆ¤æ–­æ˜¯å¦å¯å¤„ç†URL
      - fetch(url, context): æ‰§è¡Œçˆ¬å–
      - _connect_to_chrome_debug(): è¿æ¥åˆ°9222ç«¯å£
      - _wait_for_page_load(): é¡µé¢åŠ è½½ç­‰å¾…ç­–ç•¥
      - _extract_content(): æå–é¡µé¢å†…å®¹
      - _handle_errors(): é”™è¯¯å¤„ç†å’Œé™çº§
    
    å…³é”®é…ç½®:
      - debug_port: 9222
      - timeout: 30ç§’
      - wait_strategy: 'document_ready'
      - headless: False (ä½¿ç”¨Debugæ¨¡å¼)
```

#### 12.3.2 Chromeè¿æ¥ç®¡ç†å™¨ / Chrome Connection Manager

```python
# æ–‡ä»¶: plugins/selenium/chrome_manager.py
# æ¶æ„è§„èŒƒ:

class ChromeDebugManager:
    """
    Chrome Debugæ¨¡å¼è¿æ¥ç®¡ç†å™¨
    """
    
    èŒè´£:
      - æ£€æµ‹Chrome Debugå®ä¾‹æ˜¯å¦è¿è¡Œ
      - å»ºç«‹ä¸è°ƒè¯•ç«¯å£çš„è¿æ¥
      - ç®¡ç†WebDriverå®ä¾‹ç”Ÿå‘½å‘¨æœŸ
      - å¤„ç†è¿æ¥å¤±è´¥å’Œé‡è¯•
    
    æ¥å£è®¾è®¡:
      - is_debug_running() -> bool: æ£€æŸ¥9222ç«¯å£
      - get_driver() -> WebDriver: è·å–è¿æ¥çš„driver
      - close_driver(): å…³é—­driverä½†ä¿æŒChromeè¿è¡Œ
      - start_debug_if_needed(): å¿…è¦æ—¶å¯åŠ¨Chrome Debug
```

### 12.4 å®æ–½æ­¥éª¤å’Œæ—¶é—´å®‰æ’ / Implementation Steps and Timeline

#### 12.4.1 ç¬¬ä¸€å¤©ï¼šåŸºç¡€æ¶æ„è°ƒæ•´ / Day 1: Basic Architecture

```yaml
ä¸Šåˆ (4å°æ—¶):
  ä»»åŠ¡1: é…ç½®é©±åŠ¨çš„æ’ä»¶ç®¡ç†å®ç° (1å°æ—¶)
    - [ ] åˆ›å»ºplugins/plugin_config.pyé…ç½®æ–‡ä»¶
    - [ ] å®šä¹‰ENABLED_PLUGINSåˆ—è¡¨ï¼ˆåªå«urllibå’Œseleniumï¼‰
    - [ ] ä¿®æ”¹registry.pyæ·»åŠ é…ç½®æ£€æŸ¥ï¼ˆä¸åˆ é™¤ä»»ä½•ä»£ç ï¼‰
    - [ ] éªŒè¯é…ç½®æ§åˆ¶ç”Ÿæ•ˆ
    - [ ] æäº¤: "feat: implement config-driven plugin management (preserve all code)"
  
  ä»»åŠ¡2: CLIå‚æ•°ç³»ç»Ÿ (2å°æ—¶)
    - [ ] ä¿®æ”¹webfetcher.pyæ·»åŠ --methodå‚æ•°
    - [ ] æ·»åŠ --no-fallbackå‚æ•°
    - [ ] æ›´æ–°--helpæ–‡æ¡£
    - [ ] æäº¤: "feat: add --method CLI parameter for fetch method selection"
  
  ä»»åŠ¡3: åŸºç¡€æµ‹è¯• (1å°æ—¶)
    - [ ] æµ‹è¯•urllibæ¨¡å¼æ­£å¸¸
    - [ ] æµ‹è¯•å‚æ•°è§£ææ­£ç¡®
    - [ ] éªŒè¯å‘åå…¼å®¹æ€§

ä¸‹åˆ (4å°æ—¶):
  ä»»åŠ¡4: Seleniumæ’ä»¶æ¡†æ¶ (2å°æ—¶)
    - [ ] åˆ›å»ºplugins/selenium/ç›®å½•ç»“æ„
    - [ ] å®ç°åŸºç¡€plugin.pyæ¡†æ¶
    - [ ] å®ç°config.pyé…ç½®
    - [ ] æäº¤: "feat: add selenium plugin framework"
  
  ä»»åŠ¡5: Chromeè¿æ¥å®ç° (2å°æ—¶)
    - [ ] å®ç°chrome_manager.py
    - [ ] è¿æ¥åˆ°9222ç«¯å£
    - [ ] åŸºç¡€é¡µé¢è·å–æµ‹è¯•
    - [ ] æäº¤: "feat: implement Chrome Debug connection"

éªŒæ”¶æ ‡å‡†:
  âœ“ urllibå•ç‹¬å·¥ä½œæ­£å¸¸
  âœ“ Seleniumæ¡†æ¶å°±ä½
  âœ“ Chrome Debugè¿æ¥æˆåŠŸ
```

#### 12.4.2 ç¬¬äºŒå¤©ï¼šæ ¸å¿ƒåŠŸèƒ½å®ç° / Day 2: Core Implementation

```yaml
ä¸Šåˆ (4å°æ—¶):
  ä»»åŠ¡6: Seleniumå®Œæ•´å®ç° (2å°æ—¶)
    - [ ] å®ç°fetchæ–¹æ³•
    - [ ] æ·»åŠ ç­‰å¾…ç­–ç•¥
    - [ ] JavaScriptæ‰§è¡Œæ”¯æŒ
    - [ ] æäº¤: "feat: complete selenium fetcher implementation"
  
  ä»»åŠ¡7: æ’ä»¶æ³¨å†Œé›†æˆ (1å°æ—¶)
    - [ ] ä¿®æ”¹registry.pyæ³¨å†ŒSelenium
    - [ ] å®ç°ä¼˜å…ˆçº§è°ƒæ•´æœºåˆ¶
    - [ ] æµ‹è¯•æ’ä»¶åˆ‡æ¢
    - [ ] æäº¤: "feat: integrate selenium into plugin registry"
  
  ä»»åŠ¡8: é™çº§é€»è¾‘å®ç° (1å°æ—¶)
    - [ ] å®ç°è‡ªåŠ¨é™çº§æœºåˆ¶
    - [ ] æ·»åŠ é™çº§æ—¥å¿—
    - [ ] å¤„ç†no-fallbackæ ‡å¿—
    - [ ] æäº¤: "feat: implement automatic fallback logic"

ä¸‹åˆ (4å°æ—¶):
  ä»»åŠ¡9: é›†æˆæµ‹è¯• (2å°æ—¶)
    - [ ] åˆ›å»ºtest_integration.py
    - [ ] æµ‹è¯•urllibâ†’seleniumé™çº§
    - [ ] æµ‹è¯•å¼ºåˆ¶æ¨¡å¼
    - [ ] æäº¤: "test: add integration tests"
  
  ä»»åŠ¡10: æ€§èƒ½ä¼˜åŒ– (2å°æ—¶)
    - [ ] ä¼˜åŒ–Chromeè¿æ¥å¤ç”¨
    - [ ] å‡å°‘ç­‰å¾…æ—¶é—´
    - [ ] å†…å­˜ç®¡ç†ä¼˜åŒ–
    - [ ] æäº¤: "perf: optimize selenium performance"

éªŒæ”¶æ ‡å‡†:
  âœ“ SeleniumæˆåŠŸè·å–JavaScripté¡µé¢
  âœ“ è‡ªåŠ¨é™çº§æ­£ç¡®è§¦å‘
  âœ“ æ‰€æœ‰æµ‹è¯•é€šè¿‡
```

#### 12.4.3 ç¬¬ä¸‰å¤©ï¼šå®Œå–„å’Œæ–‡æ¡£ / Day 3: Polish and Documentation

```yaml
ä¸Šåˆ (4å°æ—¶):
  ä»»åŠ¡11: è¾¹ç¼˜æƒ…å†µå¤„ç† (2å°æ—¶)
    - [ ] Chromeæœªå¯åŠ¨å¤„ç†
    - [ ] ç½‘ç»œè¶…æ—¶ä¼˜åŒ–
    - [ ] å¤§æ–‡ä»¶å¤„ç†
    - [ ] æäº¤: "fix: handle edge cases"
  
  ä»»åŠ¡12: é”™è¯¯æ¶ˆæ¯ä¼˜åŒ– (2å°æ—¶)
    - [ ] æ¸…æ™°çš„é”™è¯¯æç¤º
    - [ ] ç”¨æˆ·æ“ä½œæŒ‡å—
    - [ ] è°ƒè¯•ä¿¡æ¯è¾“å‡º
    - [ ] æäº¤: "improve: enhance error messages"

ä¸‹åˆ (4å°æ—¶):
  ä»»åŠ¡13: æ–‡æ¡£æ›´æ–° (2å°æ—¶)
    - [ ] æ›´æ–°README.md
    - [ ] æ·»åŠ ä½¿ç”¨ç¤ºä¾‹
    - [ ] ç¼–å†™æ•…éšœæ’æŸ¥æŒ‡å—
    - [ ] æäº¤: "docs: update documentation"
  
  ä»»åŠ¡14: æœ€ç»ˆéªŒè¯ (2å°æ—¶)
    - [ ] å®Œæ•´åŠŸèƒ½æµ‹è¯•
    - [ ] æ€§èƒ½åŸºå‡†æµ‹è¯•
    - [ ] å›å½’æµ‹è¯•
    - [ ] æäº¤: "test: final validation"

éªŒæ”¶æ ‡å‡†:
  âœ“ æ‰€æœ‰åŠŸèƒ½æ­£å¸¸
  âœ“ æ–‡æ¡£å®Œæ•´æ¸…æ™°
  âœ“ å¯å‘å¸ƒçŠ¶æ€
```

### 12.5 æµ‹è¯•éªŒè¯æ–¹æ¡ˆ / Test Validation Plan

#### 12.5.1 å•å…ƒæµ‹è¯•è¦†ç›– / Unit Test Coverage

```yaml
æµ‹è¯•æ–‡ä»¶ç»“æ„:
  tests/unit/:
    test_selenium_plugin.py:
      - test_chrome_connection()
      - test_page_wait_strategy()
      - test_javascript_execution()
      - test_error_handling()
    
    test_cli_parameters.py:
      - test_method_parameter_parsing()
      - test_no_fallback_flag()
      - test_invalid_method_rejection()
    
    test_registry_priority.py:
      - test_priority_adjustment()
      - test_plugin_disable()
      - test_plugin_sorting()
```

#### 12.5.2 é›†æˆæµ‹è¯•åœºæ™¯ / Integration Test Scenarios

```yaml
æ ¸å¿ƒåœºæ™¯æµ‹è¯•:
  1. è‡ªåŠ¨æ¨¡å¼æµ‹è¯•:
     - é™æ€é¡µé¢ â†’ urllibæˆåŠŸ
     - JavaScripté¡µé¢ â†’ urllibå¤±è´¥ â†’ seleniumæˆåŠŸ
     - ä¸¤è€…éƒ½å¤±è´¥ â†’ è¿”å›é”™è¯¯
  
  2. å¼ºåˆ¶æ¨¡å¼æµ‹è¯•:
     - --method urllib â†’ åªç”¨urllib
     - --method selenium â†’ åªç”¨selenium
     - --no-fallback â†’ ç¦æ­¢é™çº§
  
  3. çœŸå®ç½‘ç«™æµ‹è¯•:
     - å¾®ä¿¡å…¬ä¼—å·æ–‡ç« 
     - å°çº¢ä¹¦åŠ¨æ€é¡µé¢
     - GitHubé™æ€é¡µé¢
     - ç»´åŸºç™¾ç§‘å¤§å‹é¡µé¢

æ€§èƒ½åŸºå‡†:
  - urllib: < 1ç§’ (é™æ€é¡µé¢)
  - selenium: < 5ç§’ (åŠ¨æ€é¡µé¢)
  - é™çº§åˆ‡æ¢: < 0.5ç§’
```

### 12.6 å›æ»šå’Œæ£€æŸ¥ç‚¹ / Rollback and Checkpoints

#### 12.6.1 å…³é”®æ£€æŸ¥ç‚¹ / Key Checkpoints

```yaml
æ£€æŸ¥ç‚¹1 (Day 1 ç»“æŸ):
  éªŒè¯é¡¹:
    - [ ] urllibç‹¬ç«‹è¿è¡Œæ­£å¸¸
    - [ ] CLIå‚æ•°æ­£ç¡®è§£æ
    - [ ] Seleniumæ¡†æ¶ç¼–è¯‘é€šè¿‡
  å¤±è´¥å¤„ç†: å›æ»šregistry.pyï¼Œä¿æŒåŸçŠ¶

æ£€æŸ¥ç‚¹2 (Day 2 ä¸­åˆ):
  éªŒè¯é¡¹:
    - [ ] SeleniumæˆåŠŸè·å–é¡µé¢
    - [ ] Chrome Debugè¿æ¥ç¨³å®š
    - [ ] è‡³å°‘3ä¸ªç½‘ç«™æµ‹è¯•é€šè¿‡
  å¤±è´¥å¤„ç†: é™çº§ä¸ºä»…urllibæ¨¡å¼

æ£€æŸ¥ç‚¹3 (Day 2 ç»“æŸ):
  éªŒè¯é¡¹:
    - [ ] é™çº§é€»è¾‘æ­£ç¡®
    - [ ] æ‰€æœ‰é›†æˆæµ‹è¯•é€šè¿‡
    - [ ] æ— æ€§èƒ½é€€åŒ–
  å¤±è´¥å¤„ç†: å»¶æœŸä¼˜åŒ–ï¼Œä¿æŒåŸºç¡€åŠŸèƒ½

æœ€ç»ˆæ£€æŸ¥ç‚¹ (Day 3):
  éªŒè¯é¡¹:
    - [ ] åŠŸèƒ½å®Œæ•´æ€§100%
    - [ ] æµ‹è¯•è¦†ç›–ç‡>80%
    - [ ] æ–‡æ¡£å®Œæ•´æ€§æ£€æŸ¥
  å¤±è´¥å¤„ç†: å»¶æœŸå‘å¸ƒï¼Œç»§ç»­ä¼˜åŒ–
```

#### 12.6.2 å›æ»šè„šæœ¬ / Rollback Scripts

```bash
#!/bin/bash
# rollback.sh - ä¸€é”®å›æ»šè„šæœ¬

# å›æ»šåˆ°åŸå§‹çŠ¶æ€ï¼ˆé€šè¿‡é…ç½®ï¼Œä¸åˆ é™¤ä»£ç ï¼‰
rollback_to_original() {
    echo "Rolling back to original architecture..."
    # æ¢å¤åŸå§‹é…ç½®è€Œéæ¢å¤ä»£ç 
    echo "ENABLED_PLUGINS = ['HTTPFetcherPlugin', 'CurlFetcherPlugin', 'SafariFetcherPlugin', 'PlaywrightFetcherPlugin']" > plugins/plugin_config.py
    echo "Configuration rollback complete! All plugin code remains intact."
}

# åˆ‡æ¢åˆ°æç®€æ¨¡å¼ï¼ˆé…ç½®é©±åŠ¨ï¼‰
switch_to_minimal() {
    echo "Switching to minimal mode (urllib + selenium only)..."
    echo "ENABLED_PLUGINS = ['HTTPFetcherPlugin', 'SeleniumFetcherPlugin']" > plugins/plugin_config.py
    echo "Switched to minimal mode! Other plugins disabled but code preserved."
}

# å›æ»šåˆ°ä»…urllibæ¨¡å¼
rollback_to_urllib_only() {
    echo "Switching to urllib-only mode..."
    # ç¦ç”¨seleniumæ’ä»¶
    sed -i '' 's/register(SeleniumFetcherPlugin/# register(SeleniumFetcherPlugin/g' plugins/registry.py
    echo "export WF_DEFAULT_METHOD=urllib" >> ~/.bashrc
    echo "Switched to urllib-only mode!"
}

# æ£€æŸ¥ç‚¹éªŒè¯
validate_checkpoint() {
    python -c "import webfetcher; print('âœ“ Module loads')"
    python webfetcher.py --help | grep -q "method" && echo "âœ“ CLI parameters OK"
    python -m pytest tests/unit/test_urllib.py && echo "âœ“ urllib tests pass"
}
```

### 12.7 é£é™©ç¼“è§£æªæ–½ / Risk Mitigation

```yaml
æŠ€æœ¯é£é™©ç¼“è§£:
  Chromeè¿æ¥å¤±è´¥:
    - é¢„æ¡ˆ: è‡ªåŠ¨é™çº§åˆ°urllib
    - å®æ–½: æ·»åŠ è¿æ¥é‡è¯•æœºåˆ¶
    - éªŒè¯: Chromeæœªè¿è¡Œæ—¶çš„ä¼˜é›…å¤„ç†
  
  æ€§èƒ½é€€åŒ–:
    - é¢„æ¡ˆ: è®¾ç½®ä¸¥æ ¼è¶…æ—¶
    - å®æ–½: æ·»åŠ æ€§èƒ½ç›‘æ§
    - éªŒè¯: åŸºå‡†æµ‹è¯•å¯¹æ¯”
  
  å…¼å®¹æ€§é—®é¢˜:
    - é¢„æ¡ˆ: ä¿æŒå‘åå…¼å®¹æ¥å£
    - å®æ–½: æ·»åŠ å…¼å®¹æ€§æµ‹è¯•
    - éªŒè¯: ç°æœ‰è„šæœ¬ç»§ç»­å·¥ä½œ

è¿è¥é£é™©ç¼“è§£:
  ç”¨æˆ·ä½“éªŒ:
    - æ¸…æ™°çš„é”™è¯¯æ¶ˆæ¯
    - è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£
    - å¿«é€Ÿå“åº”åé¦ˆ
  
  éƒ¨ç½²é£é™©:
    - åˆ†é˜¶æ®µå‘å¸ƒ
    - ç°åº¦æµ‹è¯•
    - å¿«é€Ÿå›æ»šèƒ½åŠ›
```

### 12.8 æˆåŠŸæ ‡å‡† / Success Criteria

```yaml
åŠŸèƒ½æ ‡å‡†:
  âœ“ urllibå’Œseleniuméƒ½èƒ½ç‹¬ç«‹å·¥ä½œ
  âœ“ è‡ªåŠ¨é™çº§æœºåˆ¶æ­£ç¡®è§¦å‘
  âœ“ CLIå‚æ•°æ§åˆ¶ç²¾ç¡®
  âœ“ 7ç§æµ‹è¯•ç½‘ç«™100%æˆåŠŸ

æ€§èƒ½æ ‡å‡†:
  âœ“ urllibæ¨¡å¼: <1ç§’ (é™æ€é¡µé¢)
  âœ“ seleniumæ¨¡å¼: <5ç§’ (åŠ¨æ€é¡µé¢)
  âœ“ å†…å­˜ä½¿ç”¨: <300MB
  âœ“ CPUä½¿ç”¨: <20%

è´¨é‡æ ‡å‡†:
  âœ“ æµ‹è¯•è¦†ç›–ç‡: >80%
  âœ“ ä»£ç å®¡æŸ¥é€šè¿‡
  âœ“ æ–‡æ¡£å®Œæ•´æ€§: 100%
  âœ“ é›¶ä¸¥é‡bug

ç”¨æˆ·æ ‡å‡†:
  âœ“ ä½¿ç”¨ç®€å•ç›´è§‚
  âœ“ é”™è¯¯ä¿¡æ¯æ¸…æ™°
  âœ“ å‘åå…¼å®¹æ€§ä¿æŒ
  âœ“ æ€§èƒ½æ— æ˜æ˜¾é€€åŒ–
```

---

## é™„å½• / Appendix

### A. å‘½ä»¤é€ŸæŸ¥è¡¨ / Command Cheat Sheet

```bash
# Chrome Debugæ¨¡å¼å¯åŠ¨ï¼ˆå·²é…ç½®å®Œæˆï¼‰
open -a "Chrome Debug"      # ä»Dockæˆ–Applicationså¯åŠ¨
/Applications/Chrome\ Debug.app/Contents/MacOS/Application\ Stub  # ç›´æ¥æ‰§è¡Œ

# åŸºç¡€å‘½ä»¤
wf <url>                    # è‡ªåŠ¨é€‰æ‹©
wf <url> -m urllib          # å¼ºåˆ¶urllib
wf <url> -m selenium        # å¼ºåˆ¶seleniumï¼ˆå°†è¿æ¥åˆ°Chrome Debugï¼‰

# é«˜çº§é€‰é¡¹
wf <url> --no-fallback                  # ç¦ç”¨é™çº§
wf <url> -m selenium --selenium-headless # æ— å¤´æ¨¡å¼
wf <url> --verbose                      # è¯¦ç»†æ—¥å¿—
wf <url> --timeout 60                   # 60ç§’è¶…æ—¶

# ç¯å¢ƒå˜é‡
export WF_DEFAULT_METHOD=selenium       # æ”¹å˜é»˜è®¤æ–¹æ³•
export WF_SELENIUM_HEADLESS=true       # é»˜è®¤æ— å¤´
```

### B. ä»£ç ç¤ºä¾‹ / Code Examples

```python
# Pythoné›†æˆç¤ºä¾‹
from webfetcher import fetch

# ä½¿ç”¨urllib
result = fetch("https://api.example.com/data", method="urllib")

# ä½¿ç”¨seleniumå¤„ç†SPA
result = fetch("https://spa.example.com", method="selenium")

# è‡ªåŠ¨é€‰æ‹©
result = fetch("https://example.com")  # è‡ªåŠ¨å†³å®šæœ€ä½³æ–¹å¼
```

### C. ç‰ˆæœ¬å†å² / Version History
- v3.1 (2025-09-25): Chrome Debugé…ç½®å®Œæˆï¼ŒSeleniumé›†æˆå‡†å¤‡å°±ç»ª
- v3.0 (2025-09-25): ç”¨æˆ·å®šåˆ¶ç®€åŒ–ç‰ˆ - urllib + selenium äºŒé€‰ä¸€
- v2.0 (2025-09-25): æ¶æ„ä¼˜åŒ–ç‰ˆ - å¤æ‚å¤šæ’ä»¶ç³»ç»Ÿ
- v1.0 (åŸå§‹ç‰ˆæœ¬): åˆå§‹ææ¡ˆ

---

**æ¶æ„è®¾è®¡**: Archy-Principle-Architect  
**æœ€åæ›´æ–°**: 2025-09-25 (Chromeé…ç½®å®Œæˆæ›´æ–°)  
**çŠ¶æ€**: å®æ–½è¿›è¡Œä¸­ - ChromeåŸºç¡€è®¾æ–½å·²å°±ç»ª / Implementation In Progress - Chrome Infrastructure Ready  
**é¢„è®¡å®Œæˆ**: 2ä¸ªå·¥ä½œæ—¥ / 2 business days (èŠ‚çœ1å¤©ï¼ŒChromeé…ç½®å·²å®Œæˆ)