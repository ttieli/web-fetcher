# Generic Web Template v2.1
# Comprehensive extraction patterns for various website types
# Enhanced with multi-strategy support, CMS-specific selectors, and list-of-dict format

name: "Generic Web Template"
version: "2.1.0"
domains:
  - "*"  # Matches all domains as fallback

# ============================================================================
# SELECTOR PATTERNS - 50+ selectors for comprehensive content extraction
# ============================================================================

selectors:
  # ---------------------------------------------------------------------------
  # TITLE EXTRACTION (17+ selectors)
  # Priority: Site-specific IDs -> OG/Twitter meta -> Page title -> Semantic headings
  # ---------------------------------------------------------------------------
  title:
    # Site-specific ID selectors (v2.1.0 - highest priority)
    - selector: "#atitle"
      strategy: "css"
    - selector: "p.TitleP"
      strategy: "css"

    # Social media meta tags (high priority - most reliable)
    - selector: "meta[property='og:title']"
      strategy: "css"
      attribute: "content"
    - selector: "meta[name='twitter:title']"
      strategy: "css"
      attribute: "content"

    # Schema.org structured data
    - selector: "meta[itemprop='headline']"
      strategy: "css"
      attribute: "content"
    - selector: "meta[itemprop='name']"
      strategy: "css"
      attribute: "content"

    # Page title element
    - selector: "title"
      strategy: "css"

    # Semantic HTML headings
    - selector: "h1"
      strategy: "css"
    - selector: "article h1"
      strategy: "css"
    - selector: "main h1"
      strategy: "css"

    # Common class-based patterns
    - selector: ".headline"
      strategy: "css"
    - selector: ".post-title"
      strategy: "css"
    - selector: ".article-title"
      strategy: "css"
    - selector: ".entry-title"
      strategy: "css"
    - selector: ".page-title"
      strategy: "css"
    - selector: ".title"
      strategy: "css"

    # ID-based patterns
    - selector: "#post-title"
      strategy: "css"
    - selector: "#article-title"
      strategy: "css"

    # News site patterns
    - selector: ".story-headline"
      strategy: "css"
    - selector: ".news-title"
      strategy: "css"
    - selector: "[itemprop='headline']"
      strategy: "css"

    # Blog patterns
    - selector: ".blog-title"
      strategy: "css"
    - selector: ".post-heading"
      strategy: "css"

    # Generic heading patterns
    - selector: "header h1"
      strategy: "css"
    - selector: ".content-title"
      strategy: "css"
    - selector: ".article-heading"
      strategy: "css"

  # ---------------------------------------------------------------------------
  # CONTENT EXTRACTION (23+ selectors)
  # Priority: Site-specific IDs -> Semantic HTML5 -> Article containers
  # ---------------------------------------------------------------------------
  content:
    # Site-specific ID/class selectors (v2.1.0 - highest priority)
    - selector: "#abody"
      strategy: "css"
    - selector: "#ContDIV"
      strategy: "css"
    - selector: ".list-abody"
      strategy: "css"

    # Semantic HTML5 elements (high priority)
    - selector: "article"
      strategy: "css"
    - selector: "main"
      strategy: "css"
    - selector: "[role='main']"
      strategy: "css"
    - selector: "[role='article']"
      strategy: "css"

    # Common content class patterns
    - selector: ".post-content"
      strategy: "css"
    - selector: ".entry-content"
      strategy: "css"
    - selector: ".article-content"
      strategy: "css"
    - selector: ".article-body"
      strategy: "css"
    - selector: ".news-article"
      strategy: "css"
    - selector: ".story-body"
      strategy: "css"
    - selector: ".content-body"
      strategy: "css"
    - selector: ".post-body"
      strategy: "css"

    # Documentation and technical sites
    - selector: ".docs-content"
      strategy: "css"
    - selector: ".documentation"
      strategy: "css"
    - selector: ".markdown-body"
      strategy: "css"

    # Common ID patterns
    - selector: "#content"
      strategy: "css"
    - selector: "#main-content"
      strategy: "css"
    - selector: "#article-content"
      strategy: "css"
    - selector: "#post-content"
      strategy: "css"

    # Generic fallback
    - selector: ".content"
      strategy: "css"
    - selector: "div.text"
      strategy: "css"

    # News site patterns
    - selector: ".story-content"
      strategy: "css"
    - selector: ".news-content"
      strategy: "css"
    - selector: "[itemprop='articleBody']"
      strategy: "css"

    # Blog patterns
    - selector: ".blog-content"
      strategy: "css"
    - selector: ".post-text"
      strategy: "css"

    # Forum/discussion patterns
    - selector: ".message-body"
      strategy: "css"
    - selector: ".post-message"
      strategy: "css"

    # Technical documentation patterns
    - selector: ".doc-content"
      strategy: "css"
    - selector: ".documentation-content"
      strategy: "css"
    - selector: ".readme"
      strategy: "css"

  # ---------------------------------------------------------------------------
  # METADATA EXTRACTION (20+ metadata fields)
  # ---------------------------------------------------------------------------
  metadata:
    # Description
    description:
      - selector: "meta[property='og:description']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[name='description']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[name='twitter:description']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[itemprop='description']"
        strategy: "css"
        attribute: "content"

    # Author information
    author:
      - selector: "meta[name='author']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[property='article:author']"
        strategy: "css"
        attribute: "content"
      - selector: "[rel='author']"
        strategy: "css"
      - selector: ".author"
        strategy: "css"
      - selector: ".byline"
        strategy: "css"
      - selector: ".post-author"
        strategy: "css"
      - selector: ".author-name"
        strategy: "css"
      - selector: "span[itemprop='author']"
        strategy: "css"

    # Publication date
    date:
      - selector: "meta[property='article:published_time']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[property='article:modified_time']"
        strategy: "css"
        attribute: "content"
      - selector: "time[datetime]"
        strategy: "css"
        attribute: "datetime"
      - selector: "meta[name='date']"
        strategy: "css"
        attribute: "content"
      - selector: ".published-date"
        strategy: "css"
      - selector: ".post-date"
        strategy: "css"
      - selector: ".entry-date"
        strategy: "css"
      - selector: "time[itemprop='datePublished']"
        strategy: "css"
        attribute: "datetime"

    # Featured image
    image:
      - selector: "meta[property='og:image']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[name='twitter:image']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[name='twitter:image:src']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[itemprop='image']"
        strategy: "css"
        attribute: "content"

    # Site name
    site_name:
      - selector: "meta[property='og:site_name']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[name='application-name']"
        strategy: "css"
        attribute: "content"

    # Keywords/tags
    keywords:
      - selector: "meta[name='keywords']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[property='article:tag']"
        strategy: "css"
        attribute: "content"

    # Language
    language:
      - selector: "meta[property='og:locale']"
        strategy: "css"
        attribute: "content"
      - selector: "html[lang]"
        strategy: "css"
        attribute: "lang"
      - selector: "meta[http-equiv='content-language']"
        strategy: "css"
        attribute: "content"

    # Content type
    type:
      - selector: "meta[property='og:type']"
        strategy: "css"
        attribute: "content"
      - selector: "meta[name='article:section']"
        strategy: "css"
        attribute: "content"

    # -------------------------------------------------------------------------
    # ENHANCED METADATA (NEW IN v2.0)
    # -------------------------------------------------------------------------

    # Categories
    categories:
      - selector: "meta[property='article:section']"
        strategy: "css"
        attribute: "content"
      - selector: ".category"
        strategy: "css"
      - selector: ".post-category"
        strategy: "css"
      - selector: "[rel='category tag']"
        strategy: "css"

    # Tags
    tags:
      - selector: "meta[property='article:tag']"
        strategy: "css"
        attribute: "content"
      - selector: ".tags"
        strategy: "css"
      - selector: ".post-tags"
        strategy: "css"
      - selector: "[rel='tag']"
        strategy: "css"

    # Reading time
    reading_time:
      - selector: ".reading-time"
        strategy: "css"
      - selector: ".read-time"
        strategy: "css"
      - selector: "[itemprop='timeRequired']"
        strategy: "css"

    # Author bio
    author_bio:
      - selector: ".author-bio"
        strategy: "css"
      - selector: ".author-description"
        strategy: "css"
      - selector: "[itemprop='author'] [itemprop='description']"
        strategy: "css"

    # Author avatar
    author_avatar:
      - selector: ".author-avatar img"
        strategy: "css"
        attribute: "src"
      - selector: ".author-image img"
        strategy: "css"
        attribute: "src"

    # Canonical URL
    canonical_url:
      - selector: "link[rel='canonical']"
        strategy: "css"
        attribute: "href"
      - selector: "meta[property='og:url']"
        strategy: "css"
        attribute: "content"

    # Publisher
    publisher:
      - selector: "meta[property='article:publisher']"
        strategy: "css"
        attribute: "content"
      - selector: "[itemprop='publisher'] [itemprop='name']"
        strategy: "css"

    # Word count
    word_count:
      - selector: ".word-count"
        strategy: "css"
      - selector: "meta[name='word-count']"
        strategy: "css"
        attribute: "content"

    # Comment count
    comment_count:
      - selector: ".comment-count"
        strategy: "css"
      - selector: ".comments-count"
        strategy: "css"

    # View count
    view_count:
      - selector: ".view-count"
        strategy: "css"
      - selector: ".views"
        strategy: "css"

    # Share count
    share_count:
      - selector: ".share-count"
        strategy: "css"
      - selector: ".shares"
        strategy: "css"

    # Last modified date
    modified_date:
      - selector: "meta[property='article:modified_time']"
        strategy: "css"
        attribute: "content"
      - selector: "time[itemprop='dateModified']"
        strategy: "css"
        attribute: "datetime"

# ============================================================================
# CMS-SPECIFIC SELECTORS (NEW IN v2.0)
# Support for 6 major CMS platforms
# ============================================================================

cms_patterns:
  # WordPress
  wordpress:
    content:
      - ".entry-content"
      - ".post-content"
      - "div.content"
    title:
      - ".entry-title"
      - ".post-title"
    author:
      - ".author.vcard"
      - "span.author"
    date:
      - ".entry-date"
      - "time.entry-date"

  # Drupal
  drupal:
    content:
      - ".field--name-body"
      - ".node__content"
    title:
      - ".node__title"
      - "h1.page-title"
    author:
      - ".field--name-uid"
      - ".username"

  # Joomla
  joomla:
    content:
      - ".item-page"
      - "div.article-content"
    title:
      - ".page-header"
      - "h2.contentheading"
    author:
      - ".createdby"
      - "dd.createdby"

  # Ghost
  ghost:
    content:
      - ".post-content"
      - ".gh-content"
    title:
      - ".post-title"
      - ".gh-article-title"
    author:
      - ".author-name"
      - ".gh-author-name"

  # Hugo
  hugo:
    content:
      - ".post-content"
      - "article.markdown"
    title:
      - ".post-title"
      - "h1.title"

  # Jekyll
  jekyll:
    content:
      - ".post-content"
      - "article.post"
    title:
      - ".post-title"
      - "h1.post-title"

# ============================================================================
# POST-PROCESSING RULES
# ============================================================================

post_process:
  # Remove unwanted elements
  - "remove_scripts"           # Strip <script> tags
  - "remove_styles"            # Strip <style> tags
  - "remove_comments"          # Strip HTML comments
  - "remove_ads"               # Remove ad containers
  - "remove_social_widgets"    # Remove social media buttons
  - "remove_navigation"        # Remove navigation menus

  # Clean up content
  - "trim_whitespace"          # Clean up excessive whitespace
  - "normalize_links"          # Convert relative to absolute URLs
  - "remove_empty_paragraphs"  # Remove <p></p> tags
  - "normalize_headings"       # Ensure heading hierarchy
  - "extract_images"           # Extract and process images

  # Quality improvements
  - "fix_encoding"             # Fix character encoding issues
  - "clean_html"               # Remove unnecessary HTML attributes
  - "deduplicate_content"      # Remove duplicate paragraphs

# Exclusion patterns (elements to always remove)
exclude_patterns:
  classes:
    - "advertisement"
    - "ad-container"
    - "social-share"
    - "related-posts"
    - "comments-section"
    - "sidebar"
    - "footer"
    - "header"
    - "navigation"
    - "nav"
    - "menu"
    - "widget"
    - "popup"
    - "modal"

  ids:
    - "comments"
    - "sidebar"
    - "footer"
    - "header"
    - "navigation"
    - "ad"
    - "ads"

  tags:
    - "script"
    - "style"
    - "noscript"
    - "iframe"

# ============================================================================
# QUALITY THRESHOLDS
# ============================================================================

quality:
  # Content validation
  min_content_length: 100      # Minimum characters for valid content
  max_title_length: 200        # Maximum title length
  min_title_length: 10         # Minimum title length
  require_title: true          # Title is mandatory
  require_content: true        # Content is mandatory

  # Content quality indicators
  min_paragraph_length: 20     # Minimum characters per paragraph
  min_paragraphs: 1            # Minimum number of paragraphs
  max_link_density: 0.5        # Maximum ratio of links to text

  # Image quality
  min_image_width: 200         # Minimum image width in pixels
  min_image_height: 200        # Minimum image height in pixels

  # Language detection
  detect_language: true        # Auto-detect content language
  min_text_for_detection: 100  # Minimum text length for language detection

# ============================================================================
# EXTRACTION STRATEGIES (NEW IN v2.0)
# Multi-strategy support for robust extraction
# ============================================================================

strategies:
  primary: "css"               # Primary extraction strategy
  fallback:
    - "xpath"                  # First fallback
    - "text_pattern"           # Second fallback

  # Strategy-specific options
  css_options:
    parser: "html.parser"      # BeautifulSoup parser
    strict: false              # Allow fuzzy matching

  xpath_options:
    namespaces: {}             # Custom namespaces
    strict: false

  text_pattern_options:
    case_sensitive: false
    multiline: true
    dotall: true

# ============================================================================
# PERFORMANCE OPTIMIZATION
# ============================================================================

performance:
  # Caching
  cache_templates: true        # Cache compiled templates
  cache_timeout: 3600          # Cache timeout in seconds

  # Limits
  max_document_size: 10485760  # 10MB max document size
  max_extraction_time: 5000    # 5 seconds max extraction time (ms)

  # Optimization flags
  lazy_load_images: false      # Don't wait for image loading
  parallel_extraction: false   # Sequential extraction (more reliable)

# ============================================================================
# OUTPUT CONFIGURATION
# ============================================================================

output:
  format: "markdown"           # Output format
  include_metadata: true       # Include metadata in output
  include_images: true         # Include images in output
  include_links: true          # Preserve links

  # Markdown options
  markdown_options:
    heading_style: "atx"       # Use # style headings
    bullet_style: "-"          # Use - for bullets
    code_language: "python"    # Default code block language
    wrap_width: 0              # No line wrapping

  # Metadata format
  metadata_format: "yaml"      # YAML frontmatter
  metadata_fields:             # Fields to include in output
    - title
    - author
    - date
    - description
    - keywords
    - categories
    - tags
    - canonical_url
    - reading_time
    - word_count

# ============================================================================
# VERSION HISTORY
# ============================================================================

# v2.1.0 (2025-10-10) - TemplateParser List-of-Dict Support
# - CRITICAL FIX: TemplateParser now supports list-of-dict selector format
# - Added site-specific selectors for Rodong Sinmun: p.TitleP, #ContDIV
# - Added site-specific selectors for CRI News: #atitle, #abody, .list-abody
# - TemplateParser refactored with _normalize_selector_config() method
# - Supports 3 formats: string, list-of-dict, single dict
# - Fixes Task-5 (Rodong Sinmun) and Task-6 (CRI News) empty content issues
# - 100% backward compatible with string-format templates (Wikipedia, WeChat, XHS)
# - Total selectors: 23 content + 17 title (40 total, up from 35 in v2.0)
# - Generic template now works WITHOUT site-specific templates
#
# v2.0.0 (2025-10-09)
# - Expanded from 59 to 280+ lines (374% increase)
# - Added 50+ selector patterns (150% increase from v1.1.0)
# - Added 20+ metadata fields (vs 8 in v1.1.0)
# - Multi-strategy support (CSS, XPath, Regex)
# - CMS-specific selectors for 6 platforms
# - Enhanced metadata: reading_time, categories, tags, author_bio, etc.
# - Content quality indicators and exclusion patterns
# - Performance optimization settings
# - 100% backward compatible with v1.1.0
#
# v1.1.0 (2025-10-04)
# - Initial template with basic selectors
# - 59 lines, 8 metadata fields
# - CSS-only extraction
